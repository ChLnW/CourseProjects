maude tool: 'maude'
 checking version: 2.7.1. OK.
 checking installation: OK.

theory tmp_smp begin

// Function signature and definition of the equational theory E

functions: fst/1, pair/2, snd/1
equations: fst(<x.1, x.2>) = x.1, snd(<x.1, x.2>) = x.2



restriction tg_cell_neq_restriction:
  "¬(∃ x_69 #i_68. TgCellNeq( x_69, x_69 ) @ #i_68)"
  // safety formula

lemma IRKTheftProofCareless:
  all-traces
  "∀ pid #i_50 #k_51.
    ((Distribute_IdKey_41( pid ) @ #i_50) ∧
     (Careless_Implementation_43( pid ) @ #k_51)) ⇒
    (∃ #j_52. (User_Confirmation_40( pid ) @ #j_52) ∧ (#j_52 < #i_50))"
/*
guarded formula characterizing all counter-examples:
"∃ pid #i_50 #k_51.
  (Distribute_IdKey_41( pid ) @ #i_50) ∧
  (Careless_Implementation_43( pid ) @ #k_51)
 ∧
  ∀ #j_52. (User_Confirmation_40( pid ) @ #j_52) ⇒ ¬(#j_52 < #i_50)"
*/
simplify
solve( StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, pid.1>
       ) ▶₀ #k_51 )
  case DisplayOnly_Mitm_Irk_67_manyto72tomany_case_05
  solve( Distribute_IdKey_41( ~id_66 ) @ #i_50 )
    case DisplayOnly_Mitm_Irk_67_manyto76
    solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_50 )
      case DisplayOnly_Mitm_Irk_67_72to75to76
      SOLVED // trace found
    qed
  qed
qed

lemma IRKTheftProofCareful:
  all-traces
  "∀ pid #i_55 #k_56.
    ((Distribute_IdKey_41( pid ) @ #i_55) ∧
     (Careful_Implementation_42( pid ) @ #k_56)) ⇒
    (∃ #j_57. (User_Confirmation_40( pid ) @ #j_57) ∧ (#j_57 < #i_55))"
/*
guarded formula characterizing all counter-examples:
"∃ pid #i_55 #k_56.
  (Distribute_IdKey_41( pid ) @ #i_55) ∧
  (Careful_Implementation_42( pid ) @ #k_56)
 ∧
  ∀ #j_57. (User_Confirmation_40( pid ) @ #j_57) ⇒ ¬(#j_57 < #i_55)"
*/
simplify
solve( StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, pid.1>
       ) ▶₀ #k_56 )
  case DisplayOnly_Mitm_Irk_67_manyto72tomany_case_05
  solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
    case DisplayOnly_Mitm_Irk_67_manyto74
    solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
      case DisplayOnly_Mitm_Irk_67_72to73to74
      SOLVED // trace found
    qed
  qed
qed

restriction either_careless_or_careful:
  "(∀ pid #i_60.
     (Careful_Implementation_42( pid ) @ #i_60) ⇒
     (¬(∃ #j_61. Careless_Implementation_43( pid ) @ #j_61))) ∧
   (∀ pid #i_63.
     (Careless_Implementation_43( pid ) @ #i_63) ⇒
     (¬(∃ #j_64. Careful_Implementation_42( pid ) @ #j_64)))"
  // safety formula

rule (modulo E) DisplayOnly_Mitm_Irk_67_0to1:
   [ Fr( ~pid ) ] --> [ StF( ~pid, 'tgk1', 'empty_tuple' ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_manyto1to2:
   [ StF( ~pid, 'tgk1', 'empty_tuple' ), Fr( ~id_66 ) ]
  -->
   [ StF( ~pid, 'tgk2', <'True', 'DisplayOnly', 'True', ~id_66> ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_manyto2to3:
   [
   StF( ~pid, 'tgk2',
        <tgc_idkey_0, tgc_iocap_0, tgc_mitm_0, tgc_process_id_0>
   )
   ]
  -->
   [
   StF( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_mitm_0, tgc_process_id_0>
   ),
   Out( <'Pairing_Request', tgc_idkey_0, tgc_mitm_0, tgc_iocap_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_manyto3tomany:
   [
   StF( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_mitm_0, tgc_process_id_0>
   ),
   In( <'Pairing_Response', idkey_47, mitm_45, iocap_46> )
   ]
  -->
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, iocap_46, idkey_47, tgc_mitm_0, mitm_45, 
         tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_3to4to67:
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 'False', 
         'False', tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_3to5tomany:
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 'True', 
         tgc_mitm_b_0, tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_5to6tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_6to7to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_6to8to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_6to9to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_6to10to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_6to11to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_5to12tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayYesNo', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_12to13to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_12to14to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_12to15to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_12to16to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_12to17to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_5to18tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_18to19to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_18to20to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_18to21to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_18to22to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_18to23to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_5to24tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_24to25to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_24to26to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_24to27to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_24to28to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_24to29to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_5to30tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_30to31to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_30to32to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_30to33to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_30to34to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_30to35to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_3to36tomany:
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, tgc_mitm_0, 
         'True', tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_36to37tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_37to38to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_37to39to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_37to40to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_37to41to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_37to42to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_36to43tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayYesNo', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_43to44to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_43to45to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_43to46to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_43to47to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_43to48to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_36to49tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_49to50to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_49to51to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_49to52to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_49to53to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_49to54to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_36to55tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_55to56to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_55to57to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_55to58to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_55to59to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_55to60to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_36to61tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_61to62to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_61to63to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_61to64to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_61to65to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_61to66to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_67to68to70:
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, tgc_protocol_0>
   )
   ]
  --[ TgCellNeq( tgc_protocol_0, 'Just_Works' ) ]->
   [ StF( ~pid, 'tgk70', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_67to69to71:
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]
  -->
   [ StF( ~pid, 'tgk71', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_manyto70to72:
   [ StF( ~pid, 'tgk70', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  --[ User_Confirmation_40( tgc_process_id_0 ) ]->
   [ StF( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_manyto71to72:
   [ StF( ~pid, 'tgk71', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  -->
   [ StF( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_manyto72tomany:
   [ StF( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  -->
   [ StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_72to73to74:
   [ StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  --[ Careful_Implementation_42( tgc_process_id_0 ) ]->
   [ StF( ~pid, 'tgk74', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_72to75to76:
   [ StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  --[ Careless_Implementation_43( tgc_process_id_0 ) ]->
   [ StF( ~pid, 'tgk76', <tgc_irk_a_rsp_0, tgc_process_id_0> ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_manyto74:
   [ StF( ~pid, 'tgk74', <'True', 'True', tgc_process_id_0> ) ]
  --[ Distribute_IdKey_41( tgc_process_id_0 ) ]->
   [ ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_Irk_67_manyto76:
   [ StF( ~pid, 'tgk76', <'True', tgc_process_id_0> ) ]
  --[ Distribute_IdKey_41( tgc_process_id_0 ) ]->
   [ ]

  /* has exactly the trivial AC variant */

/* All well-formedness checks were successful. */

end

==============================================================================
summary of summaries:

analyzed: ./tmp/tmp_smp.tg.spthy

  IRKTheftProofCareless (all-traces): falsified - found trace (5 steps)
  IRKTheftProofCareful (all-traces): falsified - found trace (5 steps)

==============================================================================
maude tool: 'maude'
 checking version: 2.7.1. OK.
 checking installation: OK.

theory tmp_smp begin

// Function signature and definition of the equational theory E

functions: fst/1, pair/2, snd/1
equations: fst(<x.1, x.2>) = x.1, snd(<x.1, x.2>) = x.2



restriction tg_cell_neq_restriction:
  "¬(∃ x_69 #i_68. TgCellNeq( x_69, x_69 ) @ #i_68)"
  // safety formula

lemma IRKTheftProofCareless:
  all-traces
  "∀ pid #i_50 #k_51.
    ((Distribute_IdKey_41( pid ) @ #i_50) ∧
     (Careless_Implementation_43( pid ) @ #k_51)) ⇒
    (∃ #j_52. (User_Confirmation_40( pid ) @ #j_52) ∧ (#j_52 < #i_50))"
/*
guarded formula characterizing all counter-examples:
"∃ pid #i_50 #k_51.
  (Distribute_IdKey_41( pid ) @ #i_50) ∧
  (Careless_Implementation_43( pid ) @ #k_51)
 ∧
  ∀ #j_52. (User_Confirmation_40( pid ) @ #j_52) ⇒ ¬(#j_52 < #i_50)"
*/
simplify
solve( StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, pid.1>
       ) ▶₀ #k_51 )
  case DisplayYesNo_Mitm_Irk_67_manyto72tomany_case_07
  solve( Distribute_IdKey_41( ~id_66 ) @ #i_50 )
    case DisplayYesNo_Mitm_Irk_67_manyto76
    solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_50 )
      case DisplayYesNo_Mitm_Irk_67_72to75to76
      SOLVED // trace found
    qed
  qed
qed

lemma IRKTheftProofCareful:
  all-traces
  "∀ pid #i_55 #k_56.
    ((Distribute_IdKey_41( pid ) @ #i_55) ∧
     (Careful_Implementation_42( pid ) @ #k_56)) ⇒
    (∃ #j_57. (User_Confirmation_40( pid ) @ #j_57) ∧ (#j_57 < #i_55))"
/*
guarded formula characterizing all counter-examples:
"∃ pid #i_55 #k_56.
  (Distribute_IdKey_41( pid ) @ #i_55) ∧
  (Careful_Implementation_42( pid ) @ #k_56)
 ∧
  ∀ #j_57. (User_Confirmation_40( pid ) @ #j_57) ⇒ ¬(#j_57 < #i_55)"
*/
simplify
solve( StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, pid.1>
       ) ▶₀ #k_56 )
  case DisplayYesNo_Mitm_Irk_67_manyto72tomany_case_07
  solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
    case DisplayYesNo_Mitm_Irk_67_manyto74
    solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
      case DisplayYesNo_Mitm_Irk_67_72to73to74
      SOLVED // trace found
    qed
  qed
qed

restriction either_careless_or_careful:
  "(∀ pid #i_60.
     (Careful_Implementation_42( pid ) @ #i_60) ⇒
     (¬(∃ #j_61. Careless_Implementation_43( pid ) @ #j_61))) ∧
   (∀ pid #i_63.
     (Careless_Implementation_43( pid ) @ #i_63) ⇒
     (¬(∃ #j_64. Careful_Implementation_42( pid ) @ #j_64)))"
  // safety formula

rule (modulo E) DisplayYesNo_Mitm_Irk_67_0to1:
   [ Fr( ~pid ) ] --> [ StF( ~pid, 'tgk1', 'empty_tuple' ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_manyto1to2:
   [ StF( ~pid, 'tgk1', 'empty_tuple' ), Fr( ~id_66 ) ]
  -->
   [ StF( ~pid, 'tgk2', <'True', 'DisplayYesNo', 'True', ~id_66> ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_manyto2to3:
   [
   StF( ~pid, 'tgk2',
        <tgc_idkey_0, tgc_iocap_0, tgc_mitm_0, tgc_process_id_0>
   )
   ]
  -->
   [
   StF( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_mitm_0, tgc_process_id_0>
   ),
   Out( <'Pairing_Request', tgc_idkey_0, tgc_mitm_0, tgc_iocap_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_manyto3tomany:
   [
   StF( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_mitm_0, tgc_process_id_0>
   ),
   In( <'Pairing_Response', idkey_47, mitm_45, iocap_46> )
   ]
  -->
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, iocap_46, idkey_47, tgc_mitm_0, mitm_45, 
         tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_3to4to67:
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 'False', 
         'False', tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_3to5tomany:
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 'True', 
         tgc_mitm_b_0, tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_5to6tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_6to7to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_6to8to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_6to9to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_6to10to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_6to11to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_5to12tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayYesNo', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_12to13to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_12to14to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_12to15to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_12to16to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_12to17to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_5to18tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_18to19to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_18to20to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_18to21to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_18to22to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_18to23to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_5to24tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_24to25to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_24to26to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_24to27to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_24to28to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_24to29to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_5to30tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_30to31to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_30to32to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_30to33to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_30to34to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_30to35to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_3to36tomany:
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, tgc_mitm_0, 
         'True', tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_36to37tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_37to38to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_37to39to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_37to40to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_37to41to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_37to42to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_36to43tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayYesNo', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_43to44to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_43to45to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_43to46to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_43to47to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_43to48to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_36to49tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_49to50to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_49to51to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_49to52to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_49to53to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_49to54to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_36to55tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_55to56to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_55to57to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_55to58to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_55to59to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_55to60to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_36to61tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_61to62to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_61to63to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_61to64to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_61to65to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_61to66to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_67to68to70:
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, tgc_protocol_0>
   )
   ]
  --[ TgCellNeq( tgc_protocol_0, 'Just_Works' ) ]->
   [ StF( ~pid, 'tgk70', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_67to69to71:
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]
  -->
   [ StF( ~pid, 'tgk71', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_manyto70to72:
   [ StF( ~pid, 'tgk70', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  --[ User_Confirmation_40( tgc_process_id_0 ) ]->
   [ StF( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_manyto71to72:
   [ StF( ~pid, 'tgk71', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  -->
   [ StF( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_manyto72tomany:
   [ StF( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  -->
   [ StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_72to73to74:
   [ StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  --[ Careful_Implementation_42( tgc_process_id_0 ) ]->
   [ StF( ~pid, 'tgk74', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_72to75to76:
   [ StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  --[ Careless_Implementation_43( tgc_process_id_0 ) ]->
   [ StF( ~pid, 'tgk76', <tgc_irk_a_rsp_0, tgc_process_id_0> ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_manyto74:
   [ StF( ~pid, 'tgk74', <'True', 'True', tgc_process_id_0> ) ]
  --[ Distribute_IdKey_41( tgc_process_id_0 ) ]->
   [ ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_Irk_67_manyto76:
   [ StF( ~pid, 'tgk76', <'True', tgc_process_id_0> ) ]
  --[ Distribute_IdKey_41( tgc_process_id_0 ) ]->
   [ ]

  /* has exactly the trivial AC variant */

/* All well-formedness checks were successful. */

end

==============================================================================
summary of summaries:

analyzed: ./tmp/tmp_smp.tg.spthy

  IRKTheftProofCareless (all-traces): falsified - found trace (5 steps)
  IRKTheftProofCareful (all-traces): falsified - found trace (5 steps)

==============================================================================
maude tool: 'maude'
 checking version: 2.7.1. OK.
 checking installation: OK.

theory tmp_smp begin

// Function signature and definition of the equational theory E

functions: fst/1, pair/2, snd/1
equations: fst(<x.1, x.2>) = x.1, snd(<x.1, x.2>) = x.2



restriction tg_cell_neq_restriction:
  "¬(∃ x_69 #i_68. TgCellNeq( x_69, x_69 ) @ #i_68)"
  // safety formula

lemma IRKTheftProofCareless:
  all-traces
  "∀ pid #i_50 #k_51.
    ((Distribute_IdKey_41( pid ) @ #i_50) ∧
     (Careless_Implementation_43( pid ) @ #k_51)) ⇒
    (∃ #j_52. (User_Confirmation_40( pid ) @ #j_52) ∧ (#j_52 < #i_50))"
/*
guarded formula characterizing all counter-examples:
"∃ pid #i_50 #k_51.
  (Distribute_IdKey_41( pid ) @ #i_50) ∧
  (Careless_Implementation_43( pid ) @ #k_51)
 ∧
  ∀ #j_52. (User_Confirmation_40( pid ) @ #j_52) ⇒ ¬(#j_52 < #i_50)"
*/
simplify
solve( StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, pid.1>
       ) ▶₀ #k_51 )
  case KeyboardOnly_Mitm_Irk_67_manyto72tomany_case_09
  solve( Distribute_IdKey_41( ~id_66 ) @ #i_50 )
    case KeyboardOnly_Mitm_Irk_67_manyto76
    solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_50 )
      case KeyboardOnly_Mitm_Irk_67_72to75to76
      SOLVED // trace found
    qed
  qed
qed

lemma IRKTheftProofCareful:
  all-traces
  "∀ pid #i_55 #k_56.
    ((Distribute_IdKey_41( pid ) @ #i_55) ∧
     (Careful_Implementation_42( pid ) @ #k_56)) ⇒
    (∃ #j_57. (User_Confirmation_40( pid ) @ #j_57) ∧ (#j_57 < #i_55))"
/*
guarded formula characterizing all counter-examples:
"∃ pid #i_55 #k_56.
  (Distribute_IdKey_41( pid ) @ #i_55) ∧
  (Careful_Implementation_42( pid ) @ #k_56)
 ∧
  ∀ #j_57. (User_Confirmation_40( pid ) @ #j_57) ⇒ ¬(#j_57 < #i_55)"
*/
simplify
solve( StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, pid.1>
       ) ▶₀ #k_56 )
  case KeyboardOnly_Mitm_Irk_67_manyto72tomany_case_09
  solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
    case KeyboardOnly_Mitm_Irk_67_manyto74
    solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
      case KeyboardOnly_Mitm_Irk_67_72to73to74
      SOLVED // trace found
    qed
  qed
qed

restriction either_careless_or_careful:
  "(∀ pid #i_60.
     (Careful_Implementation_42( pid ) @ #i_60) ⇒
     (¬(∃ #j_61. Careless_Implementation_43( pid ) @ #j_61))) ∧
   (∀ pid #i_63.
     (Careless_Implementation_43( pid ) @ #i_63) ⇒
     (¬(∃ #j_64. Careful_Implementation_42( pid ) @ #j_64)))"
  // safety formula

rule (modulo E) KeyboardOnly_Mitm_Irk_67_0to1:
   [ Fr( ~pid ) ] --> [ StF( ~pid, 'tgk1', 'empty_tuple' ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_manyto1to2:
   [ StF( ~pid, 'tgk1', 'empty_tuple' ), Fr( ~id_66 ) ]
  -->
   [ StF( ~pid, 'tgk2', <'True', 'KeyboardOnly', 'True', ~id_66> ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_manyto2to3:
   [
   StF( ~pid, 'tgk2',
        <tgc_idkey_0, tgc_iocap_0, tgc_mitm_0, tgc_process_id_0>
   )
   ]
  -->
   [
   StF( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_mitm_0, tgc_process_id_0>
   ),
   Out( <'Pairing_Request', tgc_idkey_0, tgc_mitm_0, tgc_iocap_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_manyto3tomany:
   [
   StF( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_mitm_0, tgc_process_id_0>
   ),
   In( <'Pairing_Response', idkey_47, mitm_45, iocap_46> )
   ]
  -->
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, iocap_46, idkey_47, tgc_mitm_0, mitm_45, 
         tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_3to4to67:
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 'False', 
         'False', tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_3to5tomany:
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 'True', 
         tgc_mitm_b_0, tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_5to6tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_6to7to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_6to8to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_6to9to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_6to10to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_6to11to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_5to12tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayYesNo', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_12to13to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_12to14to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_12to15to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_12to16to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_12to17to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_5to18tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_18to19to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_18to20to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_18to21to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_18to22to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_18to23to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_5to24tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_24to25to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_24to26to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_24to27to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_24to28to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_24to29to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_5to30tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_30to31to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_30to32to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_30to33to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_30to34to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_30to35to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_3to36tomany:
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, tgc_mitm_0, 
         'True', tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_36to37tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_37to38to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_37to39to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_37to40to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_37to41to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_37to42to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_36to43tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayYesNo', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_43to44to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_43to45to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_43to46to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_43to47to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_43to48to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_36to49tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_49to50to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_49to51to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_49to52to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_49to53to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_49to54to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_36to55tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_55to56to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_55to57to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_55to58to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_55to59to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_55to60to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_36to61tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_61to62to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_61to63to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_61to64to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_61to65to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_61to66to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_67to68to70:
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, tgc_protocol_0>
   )
   ]
  --[ TgCellNeq( tgc_protocol_0, 'Just_Works' ) ]->
   [ StF( ~pid, 'tgk70', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_67to69to71:
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]
  -->
   [ StF( ~pid, 'tgk71', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_manyto70to72:
   [ StF( ~pid, 'tgk70', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  --[ User_Confirmation_40( tgc_process_id_0 ) ]->
   [ StF( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_manyto71to72:
   [ StF( ~pid, 'tgk71', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  -->
   [ StF( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_manyto72tomany:
   [ StF( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  -->
   [ StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_72to73to74:
   [ StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  --[ Careful_Implementation_42( tgc_process_id_0 ) ]->
   [ StF( ~pid, 'tgk74', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_72to75to76:
   [ StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  --[ Careless_Implementation_43( tgc_process_id_0 ) ]->
   [ StF( ~pid, 'tgk76', <tgc_irk_a_rsp_0, tgc_process_id_0> ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_manyto74:
   [ StF( ~pid, 'tgk74', <'True', 'True', tgc_process_id_0> ) ]
  --[ Distribute_IdKey_41( tgc_process_id_0 ) ]->
   [ ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_Irk_67_manyto76:
   [ StF( ~pid, 'tgk76', <'True', tgc_process_id_0> ) ]
  --[ Distribute_IdKey_41( tgc_process_id_0 ) ]->
   [ ]

  /* has exactly the trivial AC variant */

/* All well-formedness checks were successful. */

end

==============================================================================
summary of summaries:

analyzed: ./tmp/tmp_smp.tg.spthy

  IRKTheftProofCareless (all-traces): falsified - found trace (5 steps)
  IRKTheftProofCareful (all-traces): falsified - found trace (5 steps)

==============================================================================
maude tool: 'maude'
 checking version: 2.7.1. OK.
 checking installation: OK.

theory tmp_smp begin

// Function signature and definition of the equational theory E

functions: fst/1, pair/2, snd/1
equations: fst(<x.1, x.2>) = x.1, snd(<x.1, x.2>) = x.2



restriction tg_cell_neq_restriction:
  "¬(∃ x_69 #i_68. TgCellNeq( x_69, x_69 ) @ #i_68)"
  // safety formula

lemma IRKTheftProofCareless:
  all-traces
  "∀ pid #i_50 #k_51.
    ((Distribute_IdKey_41( pid ) @ #i_50) ∧
     (Careless_Implementation_43( pid ) @ #k_51)) ⇒
    (∃ #j_52. (User_Confirmation_40( pid ) @ #j_52) ∧ (#j_52 < #i_50))"
/*
guarded formula characterizing all counter-examples:
"∃ pid #i_50 #k_51.
  (Distribute_IdKey_41( pid ) @ #i_50) ∧
  (Careless_Implementation_43( pid ) @ #k_51)
 ∧
  ∀ #j_52. (User_Confirmation_40( pid ) @ #j_52) ⇒ ¬(#j_52 < #i_50)"
*/
simplify
solve( StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, pid.1>
       ) ▶₀ #k_51 )
  case NoInputNoOutput_Mitm_Irk_67_manyto72tomany_case_01
  solve( Distribute_IdKey_41( ~id_66 ) @ #i_50 )
    case NoInputNoOutput_Mitm_Irk_67_manyto76
    solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_50 )
      case NoInputNoOutput_Mitm_Irk_67_72to75to76
      SOLVED // trace found
    qed
  qed
qed

lemma IRKTheftProofCareful:
  all-traces
  "∀ pid #i_55 #k_56.
    ((Distribute_IdKey_41( pid ) @ #i_55) ∧
     (Careful_Implementation_42( pid ) @ #k_56)) ⇒
    (∃ #j_57. (User_Confirmation_40( pid ) @ #j_57) ∧ (#j_57 < #i_55))"
/*
guarded formula characterizing all counter-examples:
"∃ pid #i_55 #k_56.
  (Distribute_IdKey_41( pid ) @ #i_55) ∧
  (Careful_Implementation_42( pid ) @ #k_56)
 ∧
  ∀ #j_57. (User_Confirmation_40( pid ) @ #j_57) ⇒ ¬(#j_57 < #i_55)"
*/
simplify
solve( StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, pid.1>
       ) ▶₀ #k_56 )
  case NoInputNoOutput_Mitm_Irk_67_manyto72tomany_case_01
  solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
    case NoInputNoOutput_Mitm_Irk_67_manyto74
    solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
      case NoInputNoOutput_Mitm_Irk_67_72to73to74
      SOLVED // trace found
    qed
  qed
qed

restriction either_careless_or_careful:
  "(∀ pid #i_60.
     (Careful_Implementation_42( pid ) @ #i_60) ⇒
     (¬(∃ #j_61. Careless_Implementation_43( pid ) @ #j_61))) ∧
   (∀ pid #i_63.
     (Careless_Implementation_43( pid ) @ #i_63) ⇒
     (¬(∃ #j_64. Careful_Implementation_42( pid ) @ #j_64)))"
  // safety formula

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_0to1:
   [ Fr( ~pid ) ] --> [ StF( ~pid, 'tgk1', 'empty_tuple' ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_manyto1to2:
   [ StF( ~pid, 'tgk1', 'empty_tuple' ), Fr( ~id_66 ) ]
  -->
   [ StF( ~pid, 'tgk2', <'True', 'NoInputNoOutput', 'True', ~id_66> ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_manyto2to3:
   [
   StF( ~pid, 'tgk2',
        <tgc_idkey_0, tgc_iocap_0, tgc_mitm_0, tgc_process_id_0>
   )
   ]
  -->
   [
   StF( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_mitm_0, tgc_process_id_0>
   ),
   Out( <'Pairing_Request', tgc_idkey_0, tgc_mitm_0, tgc_iocap_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_manyto3tomany:
   [
   StF( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_mitm_0, tgc_process_id_0>
   ),
   In( <'Pairing_Response', idkey_47, mitm_45, iocap_46> )
   ]
  -->
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, iocap_46, idkey_47, tgc_mitm_0, mitm_45, 
         tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_3to4to67:
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 'False', 
         'False', tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_3to5tomany:
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 'True', 
         tgc_mitm_b_0, tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_5to6tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_6to7to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_6to8to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_6to9to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_6to10to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_6to11to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_5to12tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayYesNo', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_12to13to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_12to14to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_12to15to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_12to16to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_12to17to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_5to18tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_18to19to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_18to20to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_18to21to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_18to22to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_18to23to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_5to24tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_24to25to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_24to26to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_24to27to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_24to28to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_24to29to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_5to30tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_30to31to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_30to32to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_30to33to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_30to34to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_30to35to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_3to36tomany:
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, tgc_mitm_0, 
         'True', tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_36to37tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_37to38to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_37to39to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_37to40to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_37to41to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_37to42to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_36to43tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayYesNo', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_43to44to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_43to45to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_43to46to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_43to47to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_43to48to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_36to49tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_49to50to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_49to51to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_49to52to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_49to53to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_49to54to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_36to55tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_55to56to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_55to57to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_55to58to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_55to59to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_55to60to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_36to61tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_61to62to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_61to63to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_61to64to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_61to65to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_61to66to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_67to68to70:
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, tgc_protocol_0>
   )
   ]
  --[ TgCellNeq( tgc_protocol_0, 'Just_Works' ) ]->
   [ StF( ~pid, 'tgk70', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_67to69to71:
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]
  -->
   [ StF( ~pid, 'tgk71', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_manyto70to72:
   [ StF( ~pid, 'tgk70', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  --[ User_Confirmation_40( tgc_process_id_0 ) ]->
   [ StF( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_manyto71to72:
   [ StF( ~pid, 'tgk71', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  -->
   [ StF( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_manyto72tomany:
   [ StF( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  -->
   [ StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_72to73to74:
   [ StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  --[ Careful_Implementation_42( tgc_process_id_0 ) ]->
   [ StF( ~pid, 'tgk74', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_72to75to76:
   [ StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  --[ Careless_Implementation_43( tgc_process_id_0 ) ]->
   [ StF( ~pid, 'tgk76', <tgc_irk_a_rsp_0, tgc_process_id_0> ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_manyto74:
   [ StF( ~pid, 'tgk74', <'True', 'True', tgc_process_id_0> ) ]
  --[ Distribute_IdKey_41( tgc_process_id_0 ) ]->
   [ ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_Irk_67_manyto76:
   [ StF( ~pid, 'tgk76', <'True', tgc_process_id_0> ) ]
  --[ Distribute_IdKey_41( tgc_process_id_0 ) ]->
   [ ]

  /* has exactly the trivial AC variant */

/* All well-formedness checks were successful. */

end

==============================================================================
summary of summaries:

analyzed: ./tmp/tmp_smp.tg.spthy

  IRKTheftProofCareless (all-traces): falsified - found trace (5 steps)
  IRKTheftProofCareful (all-traces): falsified - found trace (5 steps)

==============================================================================
maude tool: 'maude'
 checking version: 2.7.1. OK.
 checking installation: OK.

theory tmp_smp begin

// Function signature and definition of the equational theory E

functions: fst/1, pair/2, snd/1
equations: fst(<x.1, x.2>) = x.1, snd(<x.1, x.2>) = x.2



restriction tg_cell_neq_restriction:
  "¬(∃ x_69 #i_68. TgCellNeq( x_69, x_69 ) @ #i_68)"
  // safety formula

lemma IRKTheftProofCareless:
  all-traces
  "∀ pid #i_50 #k_51.
    ((Distribute_IdKey_41( pid ) @ #i_50) ∧
     (Careless_Implementation_43( pid ) @ #k_51)) ⇒
    (∃ #j_52. (User_Confirmation_40( pid ) @ #j_52) ∧ (#j_52 < #i_50))"
/*
guarded formula characterizing all counter-examples:
"∃ pid #i_50 #k_51.
  (Distribute_IdKey_41( pid ) @ #i_50) ∧
  (Careless_Implementation_43( pid ) @ #k_51)
 ∧
  ∀ #j_52. (User_Confirmation_40( pid ) @ #j_52) ⇒ ¬(#j_52 < #i_50)"
*/
simplify
solve( StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, pid.1>
       ) ▶₀ #k_51 )
  case KeyboardDisplay_Mitm_Irk_67_manyto72tomany_case_09
  solve( Distribute_IdKey_41( ~id_66 ) @ #i_50 )
    case KeyboardDisplay_Mitm_Irk_67_manyto76
    solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_50 )
      case KeyboardDisplay_Mitm_Irk_67_72to75to76
      SOLVED // trace found
    qed
  qed
qed

lemma IRKTheftProofCareful:
  all-traces
  "∀ pid #i_55 #k_56.
    ((Distribute_IdKey_41( pid ) @ #i_55) ∧
     (Careful_Implementation_42( pid ) @ #k_56)) ⇒
    (∃ #j_57. (User_Confirmation_40( pid ) @ #j_57) ∧ (#j_57 < #i_55))"
/*
guarded formula characterizing all counter-examples:
"∃ pid #i_55 #k_56.
  (Distribute_IdKey_41( pid ) @ #i_55) ∧
  (Careful_Implementation_42( pid ) @ #k_56)
 ∧
  ∀ #j_57. (User_Confirmation_40( pid ) @ #j_57) ⇒ ¬(#j_57 < #i_55)"
*/
simplify
solve( StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, pid.1>
       ) ▶₀ #k_56 )
  case KeyboardDisplay_Mitm_Irk_67_manyto72tomany_case_09
  solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
    case KeyboardDisplay_Mitm_Irk_67_manyto74
    solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
      case KeyboardDisplay_Mitm_Irk_67_72to73to74
      SOLVED // trace found
    qed
  qed
qed

restriction either_careless_or_careful:
  "(∀ pid #i_60.
     (Careful_Implementation_42( pid ) @ #i_60) ⇒
     (¬(∃ #j_61. Careless_Implementation_43( pid ) @ #j_61))) ∧
   (∀ pid #i_63.
     (Careless_Implementation_43( pid ) @ #i_63) ⇒
     (¬(∃ #j_64. Careful_Implementation_42( pid ) @ #j_64)))"
  // safety formula

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_0to1:
   [ Fr( ~pid ) ] --> [ StF( ~pid, 'tgk1', 'empty_tuple' ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_manyto1to2:
   [ StF( ~pid, 'tgk1', 'empty_tuple' ), Fr( ~id_66 ) ]
  -->
   [ StF( ~pid, 'tgk2', <'True', 'KeyboardDisplay', 'True', ~id_66> ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_manyto2to3:
   [
   StF( ~pid, 'tgk2',
        <tgc_idkey_0, tgc_iocap_0, tgc_mitm_0, tgc_process_id_0>
   )
   ]
  -->
   [
   StF( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_mitm_0, tgc_process_id_0>
   ),
   Out( <'Pairing_Request', tgc_idkey_0, tgc_mitm_0, tgc_iocap_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_manyto3tomany:
   [
   StF( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_mitm_0, tgc_process_id_0>
   ),
   In( <'Pairing_Response', idkey_47, mitm_45, iocap_46> )
   ]
  -->
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, iocap_46, idkey_47, tgc_mitm_0, mitm_45, 
         tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_3to4to67:
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 'False', 
         'False', tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_3to5tomany:
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 'True', 
         tgc_mitm_b_0, tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_5to6tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_6to7to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_6to8to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_6to9to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_6to10to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_6to11to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_5to12tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayYesNo', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_12to13to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_12to14to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_12to15to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_12to16to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_12to17to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_5to18tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_18to19to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_18to20to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_18to21to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_18to22to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_18to23to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_5to24tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_24to25to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_24to26to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_24to27to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_24to28to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_24to29to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_5to30tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_30to31to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_30to32to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_30to33to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_30to34to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_30to35to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_3to36tomany:
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, tgc_mitm_0, 
         'True', tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_36to37tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_37to38to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_37to39to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_37to40to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_37to41to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_37to42to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_36to43tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayYesNo', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_43to44to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_43to45to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_43to46to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_43to47to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_43to48to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_36to49tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_49to50to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_49to51to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_49to52to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_49to53to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_49to54to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_36to55tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_55to56to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_55to57to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_55to58to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_55to59to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_55to60to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_36to61tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_61to62to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_61to63to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_61to64to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_61to65to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_61to66to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_67to68to70:
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, tgc_protocol_0>
   )
   ]
  --[ TgCellNeq( tgc_protocol_0, 'Just_Works' ) ]->
   [ StF( ~pid, 'tgk70', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_67to69to71:
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]
  -->
   [ StF( ~pid, 'tgk71', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_manyto70to72:
   [ StF( ~pid, 'tgk70', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  --[ User_Confirmation_40( tgc_process_id_0 ) ]->
   [ StF( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_manyto71to72:
   [ StF( ~pid, 'tgk71', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  -->
   [ StF( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_manyto72tomany:
   [ StF( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  -->
   [ StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_72to73to74:
   [ StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  --[ Careful_Implementation_42( tgc_process_id_0 ) ]->
   [ StF( ~pid, 'tgk74', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_72to75to76:
   [ StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  --[ Careless_Implementation_43( tgc_process_id_0 ) ]->
   [ StF( ~pid, 'tgk76', <tgc_irk_a_rsp_0, tgc_process_id_0> ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_manyto74:
   [ StF( ~pid, 'tgk74', <'True', 'True', tgc_process_id_0> ) ]
  --[ Distribute_IdKey_41( tgc_process_id_0 ) ]->
   [ ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_Irk_67_manyto76:
   [ StF( ~pid, 'tgk76', <'True', tgc_process_id_0> ) ]
  --[ Distribute_IdKey_41( tgc_process_id_0 ) ]->
   [ ]

  /* has exactly the trivial AC variant */

/* All well-formedness checks were successful. */

end

==============================================================================
summary of summaries:

analyzed: ./tmp/tmp_smp.tg.spthy

  IRKTheftProofCareless (all-traces): falsified - found trace (5 steps)
  IRKTheftProofCareful (all-traces): falsified - found trace (5 steps)

==============================================================================
maude tool: 'maude'
 checking version: 2.7.1. OK.
 checking installation: OK.

theory tmp_smp begin

// Function signature and definition of the equational theory E

functions: fst/1, pair/2, snd/1
equations: fst(<x.1, x.2>) = x.1, snd(<x.1, x.2>) = x.2



restriction tg_cell_neq_restriction:
  "¬(∃ x_69 #i_68. TgCellNeq( x_69, x_69 ) @ #i_68)"
  // safety formula

lemma IRKTheftProofCareless:
  all-traces
  "∀ pid #i_50 #k_51.
    ((Distribute_IdKey_41( pid ) @ #i_50) ∧
     (Careless_Implementation_43( pid ) @ #k_51)) ⇒
    (∃ #j_52. (User_Confirmation_40( pid ) @ #j_52) ∧ (#j_52 < #i_50))"
/*
guarded formula characterizing all counter-examples:
"∃ pid #i_50 #k_51.
  (Distribute_IdKey_41( pid ) @ #i_50) ∧
  (Careless_Implementation_43( pid ) @ #k_51)
 ∧
  ∀ #j_52. (User_Confirmation_40( pid ) @ #j_52) ⇒ ¬(#j_52 < #i_50)"
*/
simplify
solve( StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, pid.1>
       ) ▶₀ #k_51 )
  case DisplayOnly_NoMitm_Irk_67_manyto72tomany_case_3
  solve( Distribute_IdKey_41( ~id_66 ) @ #i_50 )
    case DisplayOnly_NoMitm_Irk_67_manyto76
    solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_50 )
      case DisplayOnly_NoMitm_Irk_67_72to75to76
      SOLVED // trace found
    qed
  qed
qed

lemma IRKTheftProofCareful:
  all-traces
  "∀ pid #i_55 #k_56.
    ((Distribute_IdKey_41( pid ) @ #i_55) ∧
     (Careful_Implementation_42( pid ) @ #k_56)) ⇒
    (∃ #j_57. (User_Confirmation_40( pid ) @ #j_57) ∧ (#j_57 < #i_55))"
/*
guarded formula characterizing all counter-examples:
"∃ pid #i_55 #k_56.
  (Distribute_IdKey_41( pid ) @ #i_55) ∧
  (Careful_Implementation_42( pid ) @ #k_56)
 ∧
  ∀ #j_57. (User_Confirmation_40( pid ) @ #j_57) ⇒ ¬(#j_57 < #i_55)"
*/
simplify
solve( StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, pid.1>
       ) ▶₀ #k_56 )
  case DisplayOnly_NoMitm_Irk_67_manyto72tomany_case_3
  solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
    case DisplayOnly_NoMitm_Irk_67_manyto74
    solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
      case DisplayOnly_NoMitm_Irk_67_72to73to74
      SOLVED // trace found
    qed
  qed
qed

restriction either_careless_or_careful:
  "(∀ pid #i_60.
     (Careful_Implementation_42( pid ) @ #i_60) ⇒
     (¬(∃ #j_61. Careless_Implementation_43( pid ) @ #j_61))) ∧
   (∀ pid #i_63.
     (Careless_Implementation_43( pid ) @ #i_63) ⇒
     (¬(∃ #j_64. Careful_Implementation_42( pid ) @ #j_64)))"
  // safety formula

rule (modulo E) DisplayOnly_NoMitm_Irk_67_0to1:
   [ Fr( ~pid ) ] --> [ StF( ~pid, 'tgk1', 'empty_tuple' ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_manyto1to2:
   [ StF( ~pid, 'tgk1', 'empty_tuple' ), Fr( ~id_66 ) ]
  -->
   [ StF( ~pid, 'tgk2', <'True', 'DisplayOnly', 'False', ~id_66> ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_manyto2to3:
   [
   StF( ~pid, 'tgk2',
        <tgc_idkey_0, tgc_iocap_0, tgc_mitm_0, tgc_process_id_0>
   )
   ]
  -->
   [
   StF( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_mitm_0, tgc_process_id_0>
   ),
   Out( <'Pairing_Request', tgc_idkey_0, tgc_mitm_0, tgc_iocap_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_manyto3tomany:
   [
   StF( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_mitm_0, tgc_process_id_0>
   ),
   In( <'Pairing_Response', idkey_47, mitm_45, iocap_46> )
   ]
  -->
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, iocap_46, idkey_47, tgc_mitm_0, mitm_45, 
         tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_3to4to67:
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 'False', 
         'False', tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_3to5tomany:
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 'True', 
         tgc_mitm_b_0, tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_5to6tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_6to7to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_6to8to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_6to9to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_6to10to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_6to11to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_5to12tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayYesNo', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_12to13to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_12to14to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_12to15to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_12to16to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_12to17to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_5to18tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_18to19to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_18to20to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_18to21to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_18to22to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_18to23to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_5to24tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_24to25to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_24to26to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_24to27to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_24to28to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_24to29to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_5to30tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_30to31to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_30to32to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_30to33to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_30to34to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_30to35to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_3to36tomany:
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, tgc_mitm_0, 
         'True', tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_36to37tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_37to38to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_37to39to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_37to40to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_37to41to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_37to42to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_36to43tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayYesNo', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_43to44to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_43to45to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_43to46to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_43to47to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_43to48to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_36to49tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_49to50to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_49to51to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_49to52to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_49to53to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_49to54to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_36to55tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_55to56to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_55to57to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_55to58to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_55to59to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_55to60to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_36to61tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_61to62to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_61to63to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_61to64to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_61to65to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_61to66to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_67to68to70:
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, tgc_protocol_0>
   )
   ]
  --[ TgCellNeq( tgc_protocol_0, 'Just_Works' ) ]->
   [ StF( ~pid, 'tgk70', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_67to69to71:
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]
  -->
   [ StF( ~pid, 'tgk71', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_manyto70to72:
   [ StF( ~pid, 'tgk70', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  --[ User_Confirmation_40( tgc_process_id_0 ) ]->
   [ StF( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_manyto71to72:
   [ StF( ~pid, 'tgk71', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  -->
   [ StF( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_manyto72tomany:
   [ StF( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  -->
   [ StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_72to73to74:
   [ StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  --[ Careful_Implementation_42( tgc_process_id_0 ) ]->
   [ StF( ~pid, 'tgk74', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_72to75to76:
   [ StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  --[ Careless_Implementation_43( tgc_process_id_0 ) ]->
   [ StF( ~pid, 'tgk76', <tgc_irk_a_rsp_0, tgc_process_id_0> ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_manyto74:
   [ StF( ~pid, 'tgk74', <'True', 'True', tgc_process_id_0> ) ]
  --[ Distribute_IdKey_41( tgc_process_id_0 ) ]->
   [ ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_Irk_67_manyto76:
   [ StF( ~pid, 'tgk76', <'True', tgc_process_id_0> ) ]
  --[ Distribute_IdKey_41( tgc_process_id_0 ) ]->
   [ ]

  /* has exactly the trivial AC variant */

/* All well-formedness checks were successful. */

end

==============================================================================
summary of summaries:

analyzed: ./tmp/tmp_smp.tg.spthy

  IRKTheftProofCareless (all-traces): falsified - found trace (5 steps)
  IRKTheftProofCareful (all-traces): falsified - found trace (5 steps)

==============================================================================
maude tool: 'maude'
 checking version: 2.7.1. OK.
 checking installation: OK.

theory tmp_smp begin

// Function signature and definition of the equational theory E

functions: fst/1, pair/2, snd/1
equations: fst(<x.1, x.2>) = x.1, snd(<x.1, x.2>) = x.2



restriction tg_cell_neq_restriction:
  "¬(∃ x_69 #i_68. TgCellNeq( x_69, x_69 ) @ #i_68)"
  // safety formula

lemma IRKTheftProofCareless:
  all-traces
  "∀ pid #i_50 #k_51.
    ((Distribute_IdKey_41( pid ) @ #i_50) ∧
     (Careless_Implementation_43( pid ) @ #k_51)) ⇒
    (∃ #j_52. (User_Confirmation_40( pid ) @ #j_52) ∧ (#j_52 < #i_50))"
/*
guarded formula characterizing all counter-examples:
"∃ pid #i_50 #k_51.
  (Distribute_IdKey_41( pid ) @ #i_50) ∧
  (Careless_Implementation_43( pid ) @ #k_51)
 ∧
  ∀ #j_52. (User_Confirmation_40( pid ) @ #j_52) ⇒ ¬(#j_52 < #i_50)"
*/
simplify
solve( StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, pid.1>
       ) ▶₀ #k_51 )
  case DisplayYesNo_NoMitm_Irk_67_manyto72tomany_case_4
  solve( Distribute_IdKey_41( ~id_66 ) @ #i_50 )
    case DisplayYesNo_NoMitm_Irk_67_manyto76
    solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_50 )
      case DisplayYesNo_NoMitm_Irk_67_72to75to76
      SOLVED // trace found
    qed
  qed
qed

lemma IRKTheftProofCareful:
  all-traces
  "∀ pid #i_55 #k_56.
    ((Distribute_IdKey_41( pid ) @ #i_55) ∧
     (Careful_Implementation_42( pid ) @ #k_56)) ⇒
    (∃ #j_57. (User_Confirmation_40( pid ) @ #j_57) ∧ (#j_57 < #i_55))"
/*
guarded formula characterizing all counter-examples:
"∃ pid #i_55 #k_56.
  (Distribute_IdKey_41( pid ) @ #i_55) ∧
  (Careful_Implementation_42( pid ) @ #k_56)
 ∧
  ∀ #j_57. (User_Confirmation_40( pid ) @ #j_57) ⇒ ¬(#j_57 < #i_55)"
*/
simplify
solve( StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, pid.1>
       ) ▶₀ #k_56 )
  case DisplayYesNo_NoMitm_Irk_67_manyto72tomany_case_4
  solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
    case DisplayYesNo_NoMitm_Irk_67_manyto74
    solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
      case DisplayYesNo_NoMitm_Irk_67_72to73to74
      SOLVED // trace found
    qed
  qed
qed

restriction either_careless_or_careful:
  "(∀ pid #i_60.
     (Careful_Implementation_42( pid ) @ #i_60) ⇒
     (¬(∃ #j_61. Careless_Implementation_43( pid ) @ #j_61))) ∧
   (∀ pid #i_63.
     (Careless_Implementation_43( pid ) @ #i_63) ⇒
     (¬(∃ #j_64. Careful_Implementation_42( pid ) @ #j_64)))"
  // safety formula

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_0to1:
   [ Fr( ~pid ) ] --> [ StF( ~pid, 'tgk1', 'empty_tuple' ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_manyto1to2:
   [ StF( ~pid, 'tgk1', 'empty_tuple' ), Fr( ~id_66 ) ]
  -->
   [ StF( ~pid, 'tgk2', <'True', 'DisplayYesNo', 'False', ~id_66> ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_manyto2to3:
   [
   StF( ~pid, 'tgk2',
        <tgc_idkey_0, tgc_iocap_0, tgc_mitm_0, tgc_process_id_0>
   )
   ]
  -->
   [
   StF( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_mitm_0, tgc_process_id_0>
   ),
   Out( <'Pairing_Request', tgc_idkey_0, tgc_mitm_0, tgc_iocap_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_manyto3tomany:
   [
   StF( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_mitm_0, tgc_process_id_0>
   ),
   In( <'Pairing_Response', idkey_47, mitm_45, iocap_46> )
   ]
  -->
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, iocap_46, idkey_47, tgc_mitm_0, mitm_45, 
         tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_3to4to67:
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 'False', 
         'False', tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_3to5tomany:
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 'True', 
         tgc_mitm_b_0, tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_5to6tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_6to7to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_6to8to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_6to9to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_6to10to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_6to11to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_5to12tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayYesNo', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_12to13to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_12to14to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_12to15to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_12to16to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_12to17to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_5to18tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_18to19to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_18to20to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_18to21to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_18to22to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_18to23to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_5to24tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_24to25to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_24to26to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_24to27to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_24to28to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_24to29to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_5to30tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_30to31to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_30to32to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_30to33to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_30to34to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_30to35to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_3to36tomany:
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, tgc_mitm_0, 
         'True', tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_36to37tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_37to38to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_37to39to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_37to40to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_37to41to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_37to42to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_36to43tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayYesNo', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_43to44to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_43to45to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_43to46to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_43to47to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_43to48to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_36to49tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_49to50to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_49to51to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_49to52to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_49to53to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_49to54to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_36to55tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_55to56to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_55to57to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_55to58to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_55to59to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_55to60to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_36to61tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_61to62to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_61to63to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_61to64to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_61to65to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_61to66to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_67to68to70:
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, tgc_protocol_0>
   )
   ]
  --[ TgCellNeq( tgc_protocol_0, 'Just_Works' ) ]->
   [ StF( ~pid, 'tgk70', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_67to69to71:
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]
  -->
   [ StF( ~pid, 'tgk71', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_manyto70to72:
   [ StF( ~pid, 'tgk70', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  --[ User_Confirmation_40( tgc_process_id_0 ) ]->
   [ StF( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_manyto71to72:
   [ StF( ~pid, 'tgk71', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  -->
   [ StF( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_manyto72tomany:
   [ StF( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  -->
   [ StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_72to73to74:
   [ StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  --[ Careful_Implementation_42( tgc_process_id_0 ) ]->
   [ StF( ~pid, 'tgk74', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_72to75to76:
   [ StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  --[ Careless_Implementation_43( tgc_process_id_0 ) ]->
   [ StF( ~pid, 'tgk76', <tgc_irk_a_rsp_0, tgc_process_id_0> ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_manyto74:
   [ StF( ~pid, 'tgk74', <'True', 'True', tgc_process_id_0> ) ]
  --[ Distribute_IdKey_41( tgc_process_id_0 ) ]->
   [ ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_Irk_67_manyto76:
   [ StF( ~pid, 'tgk76', <'True', tgc_process_id_0> ) ]
  --[ Distribute_IdKey_41( tgc_process_id_0 ) ]->
   [ ]

  /* has exactly the trivial AC variant */

/* All well-formedness checks were successful. */

end

==============================================================================
summary of summaries:

analyzed: ./tmp/tmp_smp.tg.spthy

  IRKTheftProofCareless (all-traces): falsified - found trace (5 steps)
  IRKTheftProofCareful (all-traces): falsified - found trace (5 steps)

==============================================================================
maude tool: 'maude'
 checking version: 2.7.1. OK.
 checking installation: OK.

theory tmp_smp begin

// Function signature and definition of the equational theory E

functions: fst/1, pair/2, snd/1
equations: fst(<x.1, x.2>) = x.1, snd(<x.1, x.2>) = x.2



restriction tg_cell_neq_restriction:
  "¬(∃ x_69 #i_68. TgCellNeq( x_69, x_69 ) @ #i_68)"
  // safety formula

lemma IRKTheftProofCareless:
  all-traces
  "∀ pid #i_50 #k_51.
    ((Distribute_IdKey_41( pid ) @ #i_50) ∧
     (Careless_Implementation_43( pid ) @ #k_51)) ⇒
    (∃ #j_52. (User_Confirmation_40( pid ) @ #j_52) ∧ (#j_52 < #i_50))"
/*
guarded formula characterizing all counter-examples:
"∃ pid #i_50 #k_51.
  (Distribute_IdKey_41( pid ) @ #i_50) ∧
  (Careless_Implementation_43( pid ) @ #k_51)
 ∧
  ∀ #j_52. (User_Confirmation_40( pid ) @ #j_52) ⇒ ¬(#j_52 < #i_50)"
*/
simplify
solve( StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, pid.1>
       ) ▶₀ #k_51 )
  case KeyboardOnly_NoMitm_Irk_67_manyto72tomany_case_5
  solve( Distribute_IdKey_41( ~id_66 ) @ #i_50 )
    case KeyboardOnly_NoMitm_Irk_67_manyto76
    solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_50 )
      case KeyboardOnly_NoMitm_Irk_67_72to75to76
      SOLVED // trace found
    qed
  qed
qed

lemma IRKTheftProofCareful:
  all-traces
  "∀ pid #i_55 #k_56.
    ((Distribute_IdKey_41( pid ) @ #i_55) ∧
     (Careful_Implementation_42( pid ) @ #k_56)) ⇒
    (∃ #j_57. (User_Confirmation_40( pid ) @ #j_57) ∧ (#j_57 < #i_55))"
/*
guarded formula characterizing all counter-examples:
"∃ pid #i_55 #k_56.
  (Distribute_IdKey_41( pid ) @ #i_55) ∧
  (Careful_Implementation_42( pid ) @ #k_56)
 ∧
  ∀ #j_57. (User_Confirmation_40( pid ) @ #j_57) ⇒ ¬(#j_57 < #i_55)"
*/
simplify
solve( StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, pid.1>
       ) ▶₀ #k_56 )
  case KeyboardOnly_NoMitm_Irk_67_manyto72tomany_case_5
  solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
    case KeyboardOnly_NoMitm_Irk_67_manyto74
    solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
      case KeyboardOnly_NoMitm_Irk_67_72to73to74
      SOLVED // trace found
    qed
  qed
qed

restriction either_careless_or_careful:
  "(∀ pid #i_60.
     (Careful_Implementation_42( pid ) @ #i_60) ⇒
     (¬(∃ #j_61. Careless_Implementation_43( pid ) @ #j_61))) ∧
   (∀ pid #i_63.
     (Careless_Implementation_43( pid ) @ #i_63) ⇒
     (¬(∃ #j_64. Careful_Implementation_42( pid ) @ #j_64)))"
  // safety formula

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_0to1:
   [ Fr( ~pid ) ] --> [ StF( ~pid, 'tgk1', 'empty_tuple' ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_manyto1to2:
   [ StF( ~pid, 'tgk1', 'empty_tuple' ), Fr( ~id_66 ) ]
  -->
   [ StF( ~pid, 'tgk2', <'True', 'KeyboardOnly', 'False', ~id_66> ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_manyto2to3:
   [
   StF( ~pid, 'tgk2',
        <tgc_idkey_0, tgc_iocap_0, tgc_mitm_0, tgc_process_id_0>
   )
   ]
  -->
   [
   StF( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_mitm_0, tgc_process_id_0>
   ),
   Out( <'Pairing_Request', tgc_idkey_0, tgc_mitm_0, tgc_iocap_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_manyto3tomany:
   [
   StF( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_mitm_0, tgc_process_id_0>
   ),
   In( <'Pairing_Response', idkey_47, mitm_45, iocap_46> )
   ]
  -->
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, iocap_46, idkey_47, tgc_mitm_0, mitm_45, 
         tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_3to4to67:
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 'False', 
         'False', tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_3to5tomany:
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 'True', 
         tgc_mitm_b_0, tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_5to6tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_6to7to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_6to8to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_6to9to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_6to10to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_6to11to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_5to12tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayYesNo', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_12to13to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_12to14to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_12to15to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_12to16to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_12to17to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_5to18tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_18to19to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_18to20to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_18to21to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_18to22to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_18to23to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_5to24tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_24to25to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_24to26to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_24to27to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_24to28to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_24to29to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_5to30tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_30to31to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_30to32to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_30to33to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_30to34to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_30to35to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_3to36tomany:
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, tgc_mitm_0, 
         'True', tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_36to37tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_37to38to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_37to39to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_37to40to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_37to41to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_37to42to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_36to43tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayYesNo', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_43to44to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_43to45to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_43to46to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_43to47to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_43to48to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_36to49tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_49to50to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_49to51to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_49to52to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_49to53to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_49to54to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_36to55tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_55to56to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_55to57to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_55to58to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_55to59to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_55to60to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_36to61tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_61to62to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_61to63to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_61to64to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_61to65to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_61to66to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_67to68to70:
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, tgc_protocol_0>
   )
   ]
  --[ TgCellNeq( tgc_protocol_0, 'Just_Works' ) ]->
   [ StF( ~pid, 'tgk70', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_67to69to71:
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]
  -->
   [ StF( ~pid, 'tgk71', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_manyto70to72:
   [ StF( ~pid, 'tgk70', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  --[ User_Confirmation_40( tgc_process_id_0 ) ]->
   [ StF( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_manyto71to72:
   [ StF( ~pid, 'tgk71', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  -->
   [ StF( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_manyto72tomany:
   [ StF( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  -->
   [ StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_72to73to74:
   [ StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  --[ Careful_Implementation_42( tgc_process_id_0 ) ]->
   [ StF( ~pid, 'tgk74', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_72to75to76:
   [ StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  --[ Careless_Implementation_43( tgc_process_id_0 ) ]->
   [ StF( ~pid, 'tgk76', <tgc_irk_a_rsp_0, tgc_process_id_0> ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_manyto74:
   [ StF( ~pid, 'tgk74', <'True', 'True', tgc_process_id_0> ) ]
  --[ Distribute_IdKey_41( tgc_process_id_0 ) ]->
   [ ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_Irk_67_manyto76:
   [ StF( ~pid, 'tgk76', <'True', tgc_process_id_0> ) ]
  --[ Distribute_IdKey_41( tgc_process_id_0 ) ]->
   [ ]

  /* has exactly the trivial AC variant */

/* All well-formedness checks were successful. */

end

==============================================================================
summary of summaries:

analyzed: ./tmp/tmp_smp.tg.spthy

  IRKTheftProofCareless (all-traces): falsified - found trace (5 steps)
  IRKTheftProofCareful (all-traces): falsified - found trace (5 steps)

==============================================================================
maude tool: 'maude'
 checking version: 2.7.1. OK.
 checking installation: OK.

theory tmp_smp begin

// Function signature and definition of the equational theory E

functions: fst/1, pair/2, snd/1
equations: fst(<x.1, x.2>) = x.1, snd(<x.1, x.2>) = x.2



restriction tg_cell_neq_restriction:
  "¬(∃ x_69 #i_68. TgCellNeq( x_69, x_69 ) @ #i_68)"
  // safety formula

lemma IRKTheftProofCareless:
  all-traces
  "∀ pid #i_50 #k_51.
    ((Distribute_IdKey_41( pid ) @ #i_50) ∧
     (Careless_Implementation_43( pid ) @ #k_51)) ⇒
    (∃ #j_52. (User_Confirmation_40( pid ) @ #j_52) ∧ (#j_52 < #i_50))"
/*
guarded formula characterizing all counter-examples:
"∃ pid #i_50 #k_51.
  (Distribute_IdKey_41( pid ) @ #i_50) ∧
  (Careless_Implementation_43( pid ) @ #k_51)
 ∧
  ∀ #j_52. (User_Confirmation_40( pid ) @ #j_52) ⇒ ¬(#j_52 < #i_50)"
*/
simplify
solve( StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, pid.1>
       ) ▶₀ #k_51 )
  case NoInputNoOutput_NoMitm_Irk_67_manyto72tomany_case_1
  solve( Distribute_IdKey_41( ~id_66 ) @ #i_50 )
    case NoInputNoOutput_NoMitm_Irk_67_manyto76
    solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_50 )
      case NoInputNoOutput_NoMitm_Irk_67_72to75to76
      SOLVED // trace found
    qed
  qed
qed

lemma IRKTheftProofCareful:
  all-traces
  "∀ pid #i_55 #k_56.
    ((Distribute_IdKey_41( pid ) @ #i_55) ∧
     (Careful_Implementation_42( pid ) @ #k_56)) ⇒
    (∃ #j_57. (User_Confirmation_40( pid ) @ #j_57) ∧ (#j_57 < #i_55))"
/*
guarded formula characterizing all counter-examples:
"∃ pid #i_55 #k_56.
  (Distribute_IdKey_41( pid ) @ #i_55) ∧
  (Careful_Implementation_42( pid ) @ #k_56)
 ∧
  ∀ #j_57. (User_Confirmation_40( pid ) @ #j_57) ⇒ ¬(#j_57 < #i_55)"
*/
simplify
solve( StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, pid.1>
       ) ▶₀ #k_56 )
  case NoInputNoOutput_NoMitm_Irk_67_manyto72tomany_case_1
  solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
    case NoInputNoOutput_NoMitm_Irk_67_manyto74
    solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
      case NoInputNoOutput_NoMitm_Irk_67_72to73to74
      SOLVED // trace found
    qed
  qed
qed

restriction either_careless_or_careful:
  "(∀ pid #i_60.
     (Careful_Implementation_42( pid ) @ #i_60) ⇒
     (¬(∃ #j_61. Careless_Implementation_43( pid ) @ #j_61))) ∧
   (∀ pid #i_63.
     (Careless_Implementation_43( pid ) @ #i_63) ⇒
     (¬(∃ #j_64. Careful_Implementation_42( pid ) @ #j_64)))"
  // safety formula

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_0to1:
   [ Fr( ~pid ) ] --> [ StF( ~pid, 'tgk1', 'empty_tuple' ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_manyto1to2:
   [ StF( ~pid, 'tgk1', 'empty_tuple' ), Fr( ~id_66 ) ]
  -->
   [ StF( ~pid, 'tgk2', <'True', 'NoInputNoOutput', 'False', ~id_66> ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_manyto2to3:
   [
   StF( ~pid, 'tgk2',
        <tgc_idkey_0, tgc_iocap_0, tgc_mitm_0, tgc_process_id_0>
   )
   ]
  -->
   [
   StF( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_mitm_0, tgc_process_id_0>
   ),
   Out( <'Pairing_Request', tgc_idkey_0, tgc_mitm_0, tgc_iocap_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_manyto3tomany:
   [
   StF( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_mitm_0, tgc_process_id_0>
   ),
   In( <'Pairing_Response', idkey_47, mitm_45, iocap_46> )
   ]
  -->
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, iocap_46, idkey_47, tgc_mitm_0, mitm_45, 
         tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_3to4to67:
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 'False', 
         'False', tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_3to5tomany:
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 'True', 
         tgc_mitm_b_0, tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_5to6tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_6to7to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_6to8to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_6to9to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_6to10to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_6to11to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_5to12tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayYesNo', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_12to13to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_12to14to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_12to15to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_12to16to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_12to17to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_5to18tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_18to19to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_18to20to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_18to21to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_18to22to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_18to23to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_5to24tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_24to25to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_24to26to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_24to27to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_24to28to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_24to29to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_5to30tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_30to31to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_30to32to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_30to33to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_30to34to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_30to35to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_3to36tomany:
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, tgc_mitm_0, 
         'True', tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_36to37tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_37to38to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_37to39to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_37to40to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_37to41to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_37to42to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_36to43tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayYesNo', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_43to44to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_43to45to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_43to46to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_43to47to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_43to48to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_36to49tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_49to50to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_49to51to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_49to52to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_49to53to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_49to54to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_36to55tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_55to56to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_55to57to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_55to58to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_55to59to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_55to60to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_36to61tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_61to62to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_61to63to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_61to64to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_61to65to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_61to66to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_67to68to70:
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, tgc_protocol_0>
   )
   ]
  --[ TgCellNeq( tgc_protocol_0, 'Just_Works' ) ]->
   [ StF( ~pid, 'tgk70', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_67to69to71:
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]
  -->
   [ StF( ~pid, 'tgk71', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_manyto70to72:
   [ StF( ~pid, 'tgk70', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  --[ User_Confirmation_40( tgc_process_id_0 ) ]->
   [ StF( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_manyto71to72:
   [ StF( ~pid, 'tgk71', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  -->
   [ StF( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_manyto72tomany:
   [ StF( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  -->
   [ StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_72to73to74:
   [ StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  --[ Careful_Implementation_42( tgc_process_id_0 ) ]->
   [ StF( ~pid, 'tgk74', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_72to75to76:
   [ StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  --[ Careless_Implementation_43( tgc_process_id_0 ) ]->
   [ StF( ~pid, 'tgk76', <tgc_irk_a_rsp_0, tgc_process_id_0> ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_manyto74:
   [ StF( ~pid, 'tgk74', <'True', 'True', tgc_process_id_0> ) ]
  --[ Distribute_IdKey_41( tgc_process_id_0 ) ]->
   [ ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_Irk_67_manyto76:
   [ StF( ~pid, 'tgk76', <'True', tgc_process_id_0> ) ]
  --[ Distribute_IdKey_41( tgc_process_id_0 ) ]->
   [ ]

  /* has exactly the trivial AC variant */

/* All well-formedness checks were successful. */

end

==============================================================================
summary of summaries:

analyzed: ./tmp/tmp_smp.tg.spthy

  IRKTheftProofCareless (all-traces): falsified - found trace (5 steps)
  IRKTheftProofCareful (all-traces): falsified - found trace (5 steps)

==============================================================================
maude tool: 'maude'
 checking version: 2.7.1. OK.
 checking installation: OK.

theory tmp_smp begin

// Function signature and definition of the equational theory E

functions: fst/1, pair/2, snd/1
equations: fst(<x.1, x.2>) = x.1, snd(<x.1, x.2>) = x.2



restriction tg_cell_neq_restriction:
  "¬(∃ x_69 #i_68. TgCellNeq( x_69, x_69 ) @ #i_68)"
  // safety formula

lemma IRKTheftProofCareless:
  all-traces
  "∀ pid #i_50 #k_51.
    ((Distribute_IdKey_41( pid ) @ #i_50) ∧
     (Careless_Implementation_43( pid ) @ #k_51)) ⇒
    (∃ #j_52. (User_Confirmation_40( pid ) @ #j_52) ∧ (#j_52 < #i_50))"
/*
guarded formula characterizing all counter-examples:
"∃ pid #i_50 #k_51.
  (Distribute_IdKey_41( pid ) @ #i_50) ∧
  (Careless_Implementation_43( pid ) @ #k_51)
 ∧
  ∀ #j_52. (User_Confirmation_40( pid ) @ #j_52) ⇒ ¬(#j_52 < #i_50)"
*/
simplify
solve( StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, pid.1>
       ) ▶₀ #k_51 )
  case KeyboardDisplay_NoMitm_Irk_67_manyto72tomany_case_5
  solve( Distribute_IdKey_41( ~id_66 ) @ #i_50 )
    case KeyboardDisplay_NoMitm_Irk_67_manyto76
    solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_50 )
      case KeyboardDisplay_NoMitm_Irk_67_72to75to76
      SOLVED // trace found
    qed
  qed
qed

lemma IRKTheftProofCareful:
  all-traces
  "∀ pid #i_55 #k_56.
    ((Distribute_IdKey_41( pid ) @ #i_55) ∧
     (Careful_Implementation_42( pid ) @ #k_56)) ⇒
    (∃ #j_57. (User_Confirmation_40( pid ) @ #j_57) ∧ (#j_57 < #i_55))"
/*
guarded formula characterizing all counter-examples:
"∃ pid #i_55 #k_56.
  (Distribute_IdKey_41( pid ) @ #i_55) ∧
  (Careful_Implementation_42( pid ) @ #k_56)
 ∧
  ∀ #j_57. (User_Confirmation_40( pid ) @ #j_57) ⇒ ¬(#j_57 < #i_55)"
*/
simplify
solve( StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, pid.1>
       ) ▶₀ #k_56 )
  case KeyboardDisplay_NoMitm_Irk_67_manyto72tomany_case_5
  solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
    case KeyboardDisplay_NoMitm_Irk_67_manyto74
    solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
      case KeyboardDisplay_NoMitm_Irk_67_72to73to74
      SOLVED // trace found
    qed
  qed
qed

restriction either_careless_or_careful:
  "(∀ pid #i_60.
     (Careful_Implementation_42( pid ) @ #i_60) ⇒
     (¬(∃ #j_61. Careless_Implementation_43( pid ) @ #j_61))) ∧
   (∀ pid #i_63.
     (Careless_Implementation_43( pid ) @ #i_63) ⇒
     (¬(∃ #j_64. Careful_Implementation_42( pid ) @ #j_64)))"
  // safety formula

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_0to1:
   [ Fr( ~pid ) ] --> [ StF( ~pid, 'tgk1', 'empty_tuple' ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_manyto1to2:
   [ StF( ~pid, 'tgk1', 'empty_tuple' ), Fr( ~id_66 ) ]
  -->
   [ StF( ~pid, 'tgk2', <'True', 'KeyboardDisplay', 'False', ~id_66> ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_manyto2to3:
   [
   StF( ~pid, 'tgk2',
        <tgc_idkey_0, tgc_iocap_0, tgc_mitm_0, tgc_process_id_0>
   )
   ]
  -->
   [
   StF( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_mitm_0, tgc_process_id_0>
   ),
   Out( <'Pairing_Request', tgc_idkey_0, tgc_mitm_0, tgc_iocap_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_manyto3tomany:
   [
   StF( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_mitm_0, tgc_process_id_0>
   ),
   In( <'Pairing_Response', idkey_47, mitm_45, iocap_46> )
   ]
  -->
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, iocap_46, idkey_47, tgc_mitm_0, mitm_45, 
         tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_3to4to67:
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 'False', 
         'False', tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_3to5tomany:
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 'True', 
         tgc_mitm_b_0, tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_5to6tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_6to7to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_6to8to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_6to9to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_6to10to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_6to11to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_5to12tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayYesNo', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_12to13to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_12to14to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_12to15to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_12to16to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_12to17to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_5to18tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_18to19to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_18to20to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_18to21to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_18to22to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_18to23to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_5to24tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_24to25to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_24to26to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_24to27to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_24to28to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_24to29to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_5to30tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_30to31to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_30to32to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_30to33to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_30to34to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_30to35to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_3to36tomany:
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, tgc_mitm_0, 
         'True', tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_36to37tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_37to38to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_37to39to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_37to40to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_37to41to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_37to42to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_36to43tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayYesNo', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_43to44to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_43to45to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_43to46to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_43to47to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_43to48to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_36to49tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_49to50to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_49to51to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_49to52to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_49to53to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_49to54to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_36to55tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_55to56to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_55to57to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_55to58to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_55to59to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_55to60to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_36to61tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_61to62to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_61to63to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_61to64to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_61to65to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_61to66to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_67to68to70:
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, tgc_protocol_0>
   )
   ]
  --[ TgCellNeq( tgc_protocol_0, 'Just_Works' ) ]->
   [ StF( ~pid, 'tgk70', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_67to69to71:
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]
  -->
   [ StF( ~pid, 'tgk71', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_manyto70to72:
   [ StF( ~pid, 'tgk70', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  --[ User_Confirmation_40( tgc_process_id_0 ) ]->
   [ StF( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_manyto71to72:
   [ StF( ~pid, 'tgk71', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  -->
   [ StF( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_manyto72tomany:
   [ StF( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  -->
   [ StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_72to73to74:
   [ StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  --[ Careful_Implementation_42( tgc_process_id_0 ) ]->
   [ StF( ~pid, 'tgk74', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_72to75to76:
   [ StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  --[ Careless_Implementation_43( tgc_process_id_0 ) ]->
   [ StF( ~pid, 'tgk76', <tgc_irk_a_rsp_0, tgc_process_id_0> ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_manyto74:
   [ StF( ~pid, 'tgk74', <'True', 'True', tgc_process_id_0> ) ]
  --[ Distribute_IdKey_41( tgc_process_id_0 ) ]->
   [ ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_Irk_67_manyto76:
   [ StF( ~pid, 'tgk76', <'True', tgc_process_id_0> ) ]
  --[ Distribute_IdKey_41( tgc_process_id_0 ) ]->
   [ ]

  /* has exactly the trivial AC variant */

/* All well-formedness checks were successful. */

end

==============================================================================
summary of summaries:

analyzed: ./tmp/tmp_smp.tg.spthy

  IRKTheftProofCareless (all-traces): falsified - found trace (5 steps)
  IRKTheftProofCareful (all-traces): falsified - found trace (5 steps)

==============================================================================
maude tool: 'maude'
 checking version: 2.7.1. OK.
 checking installation: OK.

theory tmp_smp begin

// Function signature and definition of the equational theory E

functions: fst/1, pair/2, snd/1
equations: fst(<x.1, x.2>) = x.1, snd(<x.1, x.2>) = x.2



restriction tg_cell_neq_restriction:
  "¬(∃ x_69 #i_68. TgCellNeq( x_69, x_69 ) @ #i_68)"
  // safety formula

lemma IRKTheftProofCareless:
  all-traces
  "∀ pid #i_50 #k_51.
    ((Distribute_IdKey_41( pid ) @ #i_50) ∧
     (Careless_Implementation_43( pid ) @ #k_51)) ⇒
    (∃ #j_52. (User_Confirmation_40( pid ) @ #j_52) ∧ (#j_52 < #i_50))"
/*
guarded formula characterizing all counter-examples:
"∃ pid #i_50 #k_51.
  (Distribute_IdKey_41( pid ) @ #i_50) ∧
  (Careless_Implementation_43( pid ) @ #k_51)
 ∧
  ∀ #j_52. (User_Confirmation_40( pid ) @ #j_52) ⇒ ¬(#j_52 < #i_50)"
*/
simplify
solve( StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, pid.1>
       ) ▶₀ #k_51 )
  case DisplayOnly_Mitm_NoIrk_67_manyto72tomany_case_05
  solve( Distribute_IdKey_41( ~id_66 ) @ #i_50 )
    case DisplayOnly_Mitm_NoIrk_67_manyto76
    solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_50 )
      case DisplayOnly_Mitm_NoIrk_67_72to75to76
      SOLVED // trace found
    qed
  qed
qed

lemma IRKTheftProofCareful:
  all-traces
  "∀ pid #i_55 #k_56.
    ((Distribute_IdKey_41( pid ) @ #i_55) ∧
     (Careful_Implementation_42( pid ) @ #k_56)) ⇒
    (∃ #j_57. (User_Confirmation_40( pid ) @ #j_57) ∧ (#j_57 < #i_55))"
/*
guarded formula characterizing all counter-examples:
"∃ pid #i_55 #k_56.
  (Distribute_IdKey_41( pid ) @ #i_55) ∧
  (Careful_Implementation_42( pid ) @ #k_56)
 ∧
  ∀ #j_57. (User_Confirmation_40( pid ) @ #j_57) ⇒ ¬(#j_57 < #i_55)"
*/
simplify
solve( StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, pid.1>
       ) ▶₀ #k_56 )
  case DisplayOnly_Mitm_NoIrk_67_manyto72tomany_case_01
  solve( (#vr.1 = #i_55)  ∥ (#i_55 < #vr.1) )
    case case_1
    by solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
  next
    case case_2
    solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
      case DisplayOnly_Mitm_NoIrk_67_manyto74
      by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
    next
      case DisplayOnly_Mitm_NoIrk_67_manyto76
      by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
    qed
  qed
next
  case DisplayOnly_Mitm_NoIrk_67_manyto72tomany_case_02
  solve( (#vr.1 = #i_55)  ∥ (#i_55 < #vr.1) )
    case case_1
    by solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
  next
    case case_2
    solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
      case DisplayOnly_Mitm_NoIrk_67_manyto74
      by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
    next
      case DisplayOnly_Mitm_NoIrk_67_manyto76
      by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
    qed
  qed
next
  case DisplayOnly_Mitm_NoIrk_67_manyto72tomany_case_03
  solve( (#vr.1 = #i_55)  ∥ (#i_55 < #vr.1) )
    case case_1
    by solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
  next
    case case_2
    solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
      case DisplayOnly_Mitm_NoIrk_67_manyto74
      by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
    next
      case DisplayOnly_Mitm_NoIrk_67_manyto76
      by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
    qed
  qed
next
  case DisplayOnly_Mitm_NoIrk_67_manyto72tomany_case_04
  solve( (#vr.1 = #i_55)  ∥ (#i_55 < #vr.1) )
    case case_1
    by solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
  next
    case case_2
    solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
      case DisplayOnly_Mitm_NoIrk_67_manyto74
      by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
    next
      case DisplayOnly_Mitm_NoIrk_67_manyto76
      by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
    qed
  qed
next
  case DisplayOnly_Mitm_NoIrk_67_manyto72tomany_case_05
  solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
    case DisplayOnly_Mitm_NoIrk_67_manyto74
    by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
  next
    case DisplayOnly_Mitm_NoIrk_67_manyto76
    by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
  qed
next
  case DisplayOnly_Mitm_NoIrk_67_manyto72tomany_case_06
  solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
    case DisplayOnly_Mitm_NoIrk_67_manyto74
    by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
  next
    case DisplayOnly_Mitm_NoIrk_67_manyto76
    by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
  qed
next
  case DisplayOnly_Mitm_NoIrk_67_manyto72tomany_case_07
  solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
    case DisplayOnly_Mitm_NoIrk_67_manyto74
    by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
  next
    case DisplayOnly_Mitm_NoIrk_67_manyto76
    by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
  qed
next
  case DisplayOnly_Mitm_NoIrk_67_manyto72tomany_case_08
  solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
    case DisplayOnly_Mitm_NoIrk_67_manyto74
    by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
  next
    case DisplayOnly_Mitm_NoIrk_67_manyto76
    by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
  qed
next
  case DisplayOnly_Mitm_NoIrk_67_manyto72tomany_case_09
  solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
    case DisplayOnly_Mitm_NoIrk_67_manyto74
    by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
  next
    case DisplayOnly_Mitm_NoIrk_67_manyto76
    by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
  qed
next
  case DisplayOnly_Mitm_NoIrk_67_manyto72tomany_case_10
  solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
    case DisplayOnly_Mitm_NoIrk_67_manyto74
    by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
  next
    case DisplayOnly_Mitm_NoIrk_67_manyto76
    by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
  qed
qed

restriction either_careless_or_careful:
  "(∀ pid #i_60.
     (Careful_Implementation_42( pid ) @ #i_60) ⇒
     (¬(∃ #j_61. Careless_Implementation_43( pid ) @ #j_61))) ∧
   (∀ pid #i_63.
     (Careless_Implementation_43( pid ) @ #i_63) ⇒
     (¬(∃ #j_64. Careful_Implementation_42( pid ) @ #j_64)))"
  // safety formula

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_0to1:
   [ Fr( ~pid ) ] --> [ StF( ~pid, 'tgk1', 'empty_tuple' ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_manyto1to2:
   [ StF( ~pid, 'tgk1', 'empty_tuple' ), Fr( ~id_66 ) ]
  -->
   [ StF( ~pid, 'tgk2', <'False', 'DisplayOnly', 'True', ~id_66> ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_manyto2to3:
   [
   StF( ~pid, 'tgk2',
        <tgc_idkey_0, tgc_iocap_0, tgc_mitm_0, tgc_process_id_0>
   )
   ]
  -->
   [
   StF( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_mitm_0, tgc_process_id_0>
   ),
   Out( <'Pairing_Request', tgc_idkey_0, tgc_mitm_0, tgc_iocap_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_manyto3tomany:
   [
   StF( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_mitm_0, tgc_process_id_0>
   ),
   In( <'Pairing_Response', idkey_47, mitm_45, iocap_46> )
   ]
  -->
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, iocap_46, idkey_47, tgc_mitm_0, mitm_45, 
         tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_3to4to67:
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 'False', 
         'False', tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_3to5tomany:
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 'True', 
         tgc_mitm_b_0, tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_5to6tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_6to7to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_6to8to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_6to9to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_6to10to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_6to11to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_5to12tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayYesNo', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_12to13to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_12to14to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_12to15to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_12to16to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_12to17to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_5to18tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_18to19to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_18to20to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_18to21to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_18to22to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_18to23to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_5to24tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_24to25to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_24to26to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_24to27to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_24to28to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_24to29to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_5to30tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_30to31to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_30to32to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_30to33to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_30to34to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_30to35to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_3to36tomany:
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, tgc_mitm_0, 
         'True', tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_36to37tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_37to38to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_37to39to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_37to40to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_37to41to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_37to42to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_36to43tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayYesNo', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_43to44to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_43to45to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_43to46to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_43to47to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_43to48to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_36to49tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_49to50to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_49to51to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_49to52to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_49to53to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_49to54to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_36to55tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_55to56to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_55to57to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_55to58to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_55to59to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_55to60to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_36to61tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_61to62to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_61to63to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_61to64to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_61to65to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_61to66to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_67to68to70:
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, tgc_protocol_0>
   )
   ]
  --[ TgCellNeq( tgc_protocol_0, 'Just_Works' ) ]->
   [ StF( ~pid, 'tgk70', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_67to69to71:
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]
  -->
   [ StF( ~pid, 'tgk71', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_manyto70to72:
   [ StF( ~pid, 'tgk70', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  --[ User_Confirmation_40( tgc_process_id_0 ) ]->
   [ StF( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_manyto71to72:
   [ StF( ~pid, 'tgk71', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  -->
   [ StF( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_manyto72tomany:
   [ StF( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  -->
   [ StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_72to73to74:
   [ StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  --[ Careful_Implementation_42( tgc_process_id_0 ) ]->
   [ StF( ~pid, 'tgk74', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_72to75to76:
   [ StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  --[ Careless_Implementation_43( tgc_process_id_0 ) ]->
   [ StF( ~pid, 'tgk76', <tgc_irk_a_rsp_0, tgc_process_id_0> ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_manyto74:
   [ StF( ~pid, 'tgk74', <'True', 'True', tgc_process_id_0> ) ]
  --[ Distribute_IdKey_41( tgc_process_id_0 ) ]->
   [ ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_Mitm_NoIrk_67_manyto76:
   [ StF( ~pid, 'tgk76', <'True', tgc_process_id_0> ) ]
  --[ Distribute_IdKey_41( tgc_process_id_0 ) ]->
   [ ]

  /* has exactly the trivial AC variant */

/* All well-formedness checks were successful. */

end

==============================================================================
summary of summaries:

analyzed: ./tmp/tmp_smp.tg.spthy

  IRKTheftProofCareless (all-traces): falsified - found trace (5 steps)
  IRKTheftProofCareful (all-traces): verified (40 steps)

==============================================================================
maude tool: 'maude'
 checking version: 2.7.1. OK.
 checking installation: OK.

theory tmp_smp begin

// Function signature and definition of the equational theory E

functions: fst/1, pair/2, snd/1
equations: fst(<x.1, x.2>) = x.1, snd(<x.1, x.2>) = x.2



restriction tg_cell_neq_restriction:
  "¬(∃ x_69 #i_68. TgCellNeq( x_69, x_69 ) @ #i_68)"
  // safety formula

lemma IRKTheftProofCareless:
  all-traces
  "∀ pid #i_50 #k_51.
    ((Distribute_IdKey_41( pid ) @ #i_50) ∧
     (Careless_Implementation_43( pid ) @ #k_51)) ⇒
    (∃ #j_52. (User_Confirmation_40( pid ) @ #j_52) ∧ (#j_52 < #i_50))"
/*
guarded formula characterizing all counter-examples:
"∃ pid #i_50 #k_51.
  (Distribute_IdKey_41( pid ) @ #i_50) ∧
  (Careless_Implementation_43( pid ) @ #k_51)
 ∧
  ∀ #j_52. (User_Confirmation_40( pid ) @ #j_52) ⇒ ¬(#j_52 < #i_50)"
*/
simplify
solve( StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, pid.1>
       ) ▶₀ #k_51 )
  case DisplayYesNo_Mitm_NoIrk_67_manyto72tomany_case_07
  solve( Distribute_IdKey_41( ~id_66 ) @ #i_50 )
    case DisplayYesNo_Mitm_NoIrk_67_manyto76
    solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_50 )
      case DisplayYesNo_Mitm_NoIrk_67_72to75to76
      SOLVED // trace found
    qed
  qed
qed

lemma IRKTheftProofCareful:
  all-traces
  "∀ pid #i_55 #k_56.
    ((Distribute_IdKey_41( pid ) @ #i_55) ∧
     (Careful_Implementation_42( pid ) @ #k_56)) ⇒
    (∃ #j_57. (User_Confirmation_40( pid ) @ #j_57) ∧ (#j_57 < #i_55))"
/*
guarded formula characterizing all counter-examples:
"∃ pid #i_55 #k_56.
  (Distribute_IdKey_41( pid ) @ #i_55) ∧
  (Careful_Implementation_42( pid ) @ #k_56)
 ∧
  ∀ #j_57. (User_Confirmation_40( pid ) @ #j_57) ⇒ ¬(#j_57 < #i_55)"
*/
simplify
solve( StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, pid.1>
       ) ▶₀ #k_56 )
  case DisplayYesNo_Mitm_NoIrk_67_manyto72tomany_case_01
  solve( (#vr.1 = #i_55)  ∥ (#i_55 < #vr.1) )
    case case_1
    by solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
  next
    case case_2
    solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
      case DisplayYesNo_Mitm_NoIrk_67_manyto74
      by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
    next
      case DisplayYesNo_Mitm_NoIrk_67_manyto76
      by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
    qed
  qed
next
  case DisplayYesNo_Mitm_NoIrk_67_manyto72tomany_case_02
  solve( (#vr.1 = #i_55)  ∥ (#i_55 < #vr.1) )
    case case_1
    by solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
  next
    case case_2
    solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
      case DisplayYesNo_Mitm_NoIrk_67_manyto74
      by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
    next
      case DisplayYesNo_Mitm_NoIrk_67_manyto76
      by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
    qed
  qed
next
  case DisplayYesNo_Mitm_NoIrk_67_manyto72tomany_case_03
  solve( (#vr.1 = #i_55)  ∥ (#i_55 < #vr.1) )
    case case_1
    by solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
  next
    case case_2
    solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
      case DisplayYesNo_Mitm_NoIrk_67_manyto74
      by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
    next
      case DisplayYesNo_Mitm_NoIrk_67_manyto76
      by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
    qed
  qed
next
  case DisplayYesNo_Mitm_NoIrk_67_manyto72tomany_case_04
  solve( (#vr.1 = #i_55)  ∥ (#i_55 < #vr.1) )
    case case_1
    by solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
  next
    case case_2
    solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
      case DisplayYesNo_Mitm_NoIrk_67_manyto74
      by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
    next
      case DisplayYesNo_Mitm_NoIrk_67_manyto76
      by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
    qed
  qed
next
  case DisplayYesNo_Mitm_NoIrk_67_manyto72tomany_case_05
  solve( (#vr.1 = #i_55)  ∥ (#i_55 < #vr.1) )
    case case_1
    by solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
  next
    case case_2
    solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
      case DisplayYesNo_Mitm_NoIrk_67_manyto74
      by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
    next
      case DisplayYesNo_Mitm_NoIrk_67_manyto76
      by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
    qed
  qed
next
  case DisplayYesNo_Mitm_NoIrk_67_manyto72tomany_case_06
  solve( (#vr.1 = #i_55)  ∥ (#i_55 < #vr.1) )
    case case_1
    by solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
  next
    case case_2
    solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
      case DisplayYesNo_Mitm_NoIrk_67_manyto74
      by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
    next
      case DisplayYesNo_Mitm_NoIrk_67_manyto76
      by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
    qed
  qed
next
  case DisplayYesNo_Mitm_NoIrk_67_manyto72tomany_case_07
  solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
    case DisplayYesNo_Mitm_NoIrk_67_manyto74
    by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
  next
    case DisplayYesNo_Mitm_NoIrk_67_manyto76
    by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
  qed
next
  case DisplayYesNo_Mitm_NoIrk_67_manyto72tomany_case_08
  solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
    case DisplayYesNo_Mitm_NoIrk_67_manyto74
    by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
  next
    case DisplayYesNo_Mitm_NoIrk_67_manyto76
    by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
  qed
next
  case DisplayYesNo_Mitm_NoIrk_67_manyto72tomany_case_09
  solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
    case DisplayYesNo_Mitm_NoIrk_67_manyto74
    by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
  next
    case DisplayYesNo_Mitm_NoIrk_67_manyto76
    by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
  qed
next
  case DisplayYesNo_Mitm_NoIrk_67_manyto72tomany_case_10
  solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
    case DisplayYesNo_Mitm_NoIrk_67_manyto74
    by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
  next
    case DisplayYesNo_Mitm_NoIrk_67_manyto76
    by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
  qed
qed

restriction either_careless_or_careful:
  "(∀ pid #i_60.
     (Careful_Implementation_42( pid ) @ #i_60) ⇒
     (¬(∃ #j_61. Careless_Implementation_43( pid ) @ #j_61))) ∧
   (∀ pid #i_63.
     (Careless_Implementation_43( pid ) @ #i_63) ⇒
     (¬(∃ #j_64. Careful_Implementation_42( pid ) @ #j_64)))"
  // safety formula

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_0to1:
   [ Fr( ~pid ) ] --> [ StF( ~pid, 'tgk1', 'empty_tuple' ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_manyto1to2:
   [ StF( ~pid, 'tgk1', 'empty_tuple' ), Fr( ~id_66 ) ]
  -->
   [ StF( ~pid, 'tgk2', <'False', 'DisplayYesNo', 'True', ~id_66> ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_manyto2to3:
   [
   StF( ~pid, 'tgk2',
        <tgc_idkey_0, tgc_iocap_0, tgc_mitm_0, tgc_process_id_0>
   )
   ]
  -->
   [
   StF( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_mitm_0, tgc_process_id_0>
   ),
   Out( <'Pairing_Request', tgc_idkey_0, tgc_mitm_0, tgc_iocap_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_manyto3tomany:
   [
   StF( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_mitm_0, tgc_process_id_0>
   ),
   In( <'Pairing_Response', idkey_47, mitm_45, iocap_46> )
   ]
  -->
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, iocap_46, idkey_47, tgc_mitm_0, mitm_45, 
         tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_3to4to67:
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 'False', 
         'False', tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_3to5tomany:
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 'True', 
         tgc_mitm_b_0, tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_5to6tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_6to7to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_6to8to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_6to9to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_6to10to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_6to11to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_5to12tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayYesNo', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_12to13to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_12to14to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_12to15to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_12to16to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_12to17to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_5to18tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_18to19to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_18to20to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_18to21to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_18to22to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_18to23to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_5to24tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_24to25to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_24to26to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_24to27to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_24to28to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_24to29to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_5to30tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_30to31to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_30to32to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_30to33to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_30to34to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_30to35to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_3to36tomany:
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, tgc_mitm_0, 
         'True', tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_36to37tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_37to38to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_37to39to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_37to40to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_37to41to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_37to42to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_36to43tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayYesNo', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_43to44to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_43to45to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_43to46to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_43to47to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_43to48to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_36to49tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_49to50to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_49to51to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_49to52to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_49to53to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_49to54to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_36to55tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_55to56to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_55to57to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_55to58to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_55to59to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_55to60to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_36to61tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_61to62to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_61to63to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_61to64to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_61to65to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_61to66to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_67to68to70:
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, tgc_protocol_0>
   )
   ]
  --[ TgCellNeq( tgc_protocol_0, 'Just_Works' ) ]->
   [ StF( ~pid, 'tgk70', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_67to69to71:
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]
  -->
   [ StF( ~pid, 'tgk71', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_manyto70to72:
   [ StF( ~pid, 'tgk70', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  --[ User_Confirmation_40( tgc_process_id_0 ) ]->
   [ StF( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_manyto71to72:
   [ StF( ~pid, 'tgk71', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  -->
   [ StF( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_manyto72tomany:
   [ StF( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  -->
   [ StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_72to73to74:
   [ StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  --[ Careful_Implementation_42( tgc_process_id_0 ) ]->
   [ StF( ~pid, 'tgk74', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_72to75to76:
   [ StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  --[ Careless_Implementation_43( tgc_process_id_0 ) ]->
   [ StF( ~pid, 'tgk76', <tgc_irk_a_rsp_0, tgc_process_id_0> ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_manyto74:
   [ StF( ~pid, 'tgk74', <'True', 'True', tgc_process_id_0> ) ]
  --[ Distribute_IdKey_41( tgc_process_id_0 ) ]->
   [ ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_Mitm_NoIrk_67_manyto76:
   [ StF( ~pid, 'tgk76', <'True', tgc_process_id_0> ) ]
  --[ Distribute_IdKey_41( tgc_process_id_0 ) ]->
   [ ]

  /* has exactly the trivial AC variant */

/* All well-formedness checks were successful. */

end

==============================================================================
summary of summaries:

analyzed: ./tmp/tmp_smp.tg.spthy

  IRKTheftProofCareless (all-traces): falsified - found trace (5 steps)
  IRKTheftProofCareful (all-traces): verified (44 steps)

==============================================================================
maude tool: 'maude'
 checking version: 2.7.1. OK.
 checking installation: OK.

theory tmp_smp begin

// Function signature and definition of the equational theory E

functions: fst/1, pair/2, snd/1
equations: fst(<x.1, x.2>) = x.1, snd(<x.1, x.2>) = x.2



restriction tg_cell_neq_restriction:
  "¬(∃ x_69 #i_68. TgCellNeq( x_69, x_69 ) @ #i_68)"
  // safety formula

lemma IRKTheftProofCareless:
  all-traces
  "∀ pid #i_50 #k_51.
    ((Distribute_IdKey_41( pid ) @ #i_50) ∧
     (Careless_Implementation_43( pid ) @ #k_51)) ⇒
    (∃ #j_52. (User_Confirmation_40( pid ) @ #j_52) ∧ (#j_52 < #i_50))"
/*
guarded formula characterizing all counter-examples:
"∃ pid #i_50 #k_51.
  (Distribute_IdKey_41( pid ) @ #i_50) ∧
  (Careless_Implementation_43( pid ) @ #k_51)
 ∧
  ∀ #j_52. (User_Confirmation_40( pid ) @ #j_52) ⇒ ¬(#j_52 < #i_50)"
*/
simplify
solve( StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, pid.1>
       ) ▶₀ #k_51 )
  case KeyboardOnly_Mitm_NoIrk_67_manyto72tomany_case_09
  solve( Distribute_IdKey_41( ~id_66 ) @ #i_50 )
    case KeyboardOnly_Mitm_NoIrk_67_manyto76
    solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_50 )
      case KeyboardOnly_Mitm_NoIrk_67_72to75to76
      SOLVED // trace found
    qed
  qed
qed

lemma IRKTheftProofCareful:
  all-traces
  "∀ pid #i_55 #k_56.
    ((Distribute_IdKey_41( pid ) @ #i_55) ∧
     (Careful_Implementation_42( pid ) @ #k_56)) ⇒
    (∃ #j_57. (User_Confirmation_40( pid ) @ #j_57) ∧ (#j_57 < #i_55))"
/*
guarded formula characterizing all counter-examples:
"∃ pid #i_55 #k_56.
  (Distribute_IdKey_41( pid ) @ #i_55) ∧
  (Careful_Implementation_42( pid ) @ #k_56)
 ∧
  ∀ #j_57. (User_Confirmation_40( pid ) @ #j_57) ⇒ ¬(#j_57 < #i_55)"
*/
simplify
solve( StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, pid.1>
       ) ▶₀ #k_56 )
  case KeyboardOnly_Mitm_NoIrk_67_manyto72tomany_case_01
  solve( (#vr.1 = #i_55)  ∥ (#i_55 < #vr.1) )
    case case_1
    by solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
  next
    case case_2
    solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
      case KeyboardOnly_Mitm_NoIrk_67_manyto74
      by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
    next
      case KeyboardOnly_Mitm_NoIrk_67_manyto76
      by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
    qed
  qed
next
  case KeyboardOnly_Mitm_NoIrk_67_manyto72tomany_case_02
  solve( (#vr.1 = #i_55)  ∥ (#i_55 < #vr.1) )
    case case_1
    by solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
  next
    case case_2
    solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
      case KeyboardOnly_Mitm_NoIrk_67_manyto74
      by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
    next
      case KeyboardOnly_Mitm_NoIrk_67_manyto76
      by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
    qed
  qed
next
  case KeyboardOnly_Mitm_NoIrk_67_manyto72tomany_case_03
  solve( (#vr.1 = #i_55)  ∥ (#i_55 < #vr.1) )
    case case_1
    by solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
  next
    case case_2
    solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
      case KeyboardOnly_Mitm_NoIrk_67_manyto74
      by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
    next
      case KeyboardOnly_Mitm_NoIrk_67_manyto76
      by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
    qed
  qed
next
  case KeyboardOnly_Mitm_NoIrk_67_manyto72tomany_case_04
  solve( (#vr.1 = #i_55)  ∥ (#i_55 < #vr.1) )
    case case_1
    by solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
  next
    case case_2
    solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
      case KeyboardOnly_Mitm_NoIrk_67_manyto74
      by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
    next
      case KeyboardOnly_Mitm_NoIrk_67_manyto76
      by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
    qed
  qed
next
  case KeyboardOnly_Mitm_NoIrk_67_manyto72tomany_case_05
  solve( (#vr.1 = #i_55)  ∥ (#i_55 < #vr.1) )
    case case_1
    by solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
  next
    case case_2
    solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
      case KeyboardOnly_Mitm_NoIrk_67_manyto74
      by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
    next
      case KeyboardOnly_Mitm_NoIrk_67_manyto76
      by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
    qed
  qed
next
  case KeyboardOnly_Mitm_NoIrk_67_manyto72tomany_case_06
  solve( (#vr.1 = #i_55)  ∥ (#i_55 < #vr.1) )
    case case_1
    by solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
  next
    case case_2
    solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
      case KeyboardOnly_Mitm_NoIrk_67_manyto74
      by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
    next
      case KeyboardOnly_Mitm_NoIrk_67_manyto76
      by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
    qed
  qed
next
  case KeyboardOnly_Mitm_NoIrk_67_manyto72tomany_case_07
  solve( (#vr.1 = #i_55)  ∥ (#i_55 < #vr.1) )
    case case_1
    by solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
  next
    case case_2
    solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
      case KeyboardOnly_Mitm_NoIrk_67_manyto74
      by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
    next
      case KeyboardOnly_Mitm_NoIrk_67_manyto76
      by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
    qed
  qed
next
  case KeyboardOnly_Mitm_NoIrk_67_manyto72tomany_case_08
  solve( (#vr.1 = #i_55)  ∥ (#i_55 < #vr.1) )
    case case_1
    by solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
  next
    case case_2
    solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
      case KeyboardOnly_Mitm_NoIrk_67_manyto74
      by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
    next
      case KeyboardOnly_Mitm_NoIrk_67_manyto76
      by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
    qed
  qed
next
  case KeyboardOnly_Mitm_NoIrk_67_manyto72tomany_case_09
  solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
    case KeyboardOnly_Mitm_NoIrk_67_manyto74
    by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
  next
    case KeyboardOnly_Mitm_NoIrk_67_manyto76
    by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
  qed
next
  case KeyboardOnly_Mitm_NoIrk_67_manyto72tomany_case_10
  solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
    case KeyboardOnly_Mitm_NoIrk_67_manyto74
    by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
  next
    case KeyboardOnly_Mitm_NoIrk_67_manyto76
    by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
  qed
qed

restriction either_careless_or_careful:
  "(∀ pid #i_60.
     (Careful_Implementation_42( pid ) @ #i_60) ⇒
     (¬(∃ #j_61. Careless_Implementation_43( pid ) @ #j_61))) ∧
   (∀ pid #i_63.
     (Careless_Implementation_43( pid ) @ #i_63) ⇒
     (¬(∃ #j_64. Careful_Implementation_42( pid ) @ #j_64)))"
  // safety formula

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_0to1:
   [ Fr( ~pid ) ] --> [ StF( ~pid, 'tgk1', 'empty_tuple' ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_manyto1to2:
   [ StF( ~pid, 'tgk1', 'empty_tuple' ), Fr( ~id_66 ) ]
  -->
   [ StF( ~pid, 'tgk2', <'False', 'KeyboardOnly', 'True', ~id_66> ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_manyto2to3:
   [
   StF( ~pid, 'tgk2',
        <tgc_idkey_0, tgc_iocap_0, tgc_mitm_0, tgc_process_id_0>
   )
   ]
  -->
   [
   StF( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_mitm_0, tgc_process_id_0>
   ),
   Out( <'Pairing_Request', tgc_idkey_0, tgc_mitm_0, tgc_iocap_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_manyto3tomany:
   [
   StF( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_mitm_0, tgc_process_id_0>
   ),
   In( <'Pairing_Response', idkey_47, mitm_45, iocap_46> )
   ]
  -->
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, iocap_46, idkey_47, tgc_mitm_0, mitm_45, 
         tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_3to4to67:
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 'False', 
         'False', tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_3to5tomany:
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 'True', 
         tgc_mitm_b_0, tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_5to6tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_6to7to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_6to8to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_6to9to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_6to10to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_6to11to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_5to12tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayYesNo', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_12to13to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_12to14to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_12to15to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_12to16to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_12to17to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_5to18tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_18to19to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_18to20to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_18to21to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_18to22to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_18to23to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_5to24tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_24to25to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_24to26to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_24to27to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_24to28to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_24to29to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_5to30tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_30to31to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_30to32to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_30to33to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_30to34to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_30to35to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_3to36tomany:
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, tgc_mitm_0, 
         'True', tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_36to37tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_37to38to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_37to39to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_37to40to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_37to41to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_37to42to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_36to43tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayYesNo', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_43to44to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_43to45to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_43to46to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_43to47to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_43to48to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_36to49tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_49to50to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_49to51to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_49to52to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_49to53to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_49to54to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_36to55tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_55to56to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_55to57to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_55to58to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_55to59to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_55to60to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_36to61tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_61to62to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_61to63to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_61to64to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_61to65to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_61to66to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_67to68to70:
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, tgc_protocol_0>
   )
   ]
  --[ TgCellNeq( tgc_protocol_0, 'Just_Works' ) ]->
   [ StF( ~pid, 'tgk70', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_67to69to71:
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]
  -->
   [ StF( ~pid, 'tgk71', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_manyto70to72:
   [ StF( ~pid, 'tgk70', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  --[ User_Confirmation_40( tgc_process_id_0 ) ]->
   [ StF( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_manyto71to72:
   [ StF( ~pid, 'tgk71', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  -->
   [ StF( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_manyto72tomany:
   [ StF( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  -->
   [ StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_72to73to74:
   [ StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  --[ Careful_Implementation_42( tgc_process_id_0 ) ]->
   [ StF( ~pid, 'tgk74', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_72to75to76:
   [ StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  --[ Careless_Implementation_43( tgc_process_id_0 ) ]->
   [ StF( ~pid, 'tgk76', <tgc_irk_a_rsp_0, tgc_process_id_0> ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_manyto74:
   [ StF( ~pid, 'tgk74', <'True', 'True', tgc_process_id_0> ) ]
  --[ Distribute_IdKey_41( tgc_process_id_0 ) ]->
   [ ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_Mitm_NoIrk_67_manyto76:
   [ StF( ~pid, 'tgk76', <'True', tgc_process_id_0> ) ]
  --[ Distribute_IdKey_41( tgc_process_id_0 ) ]->
   [ ]

  /* has exactly the trivial AC variant */

/* All well-formedness checks were successful. */

end

==============================================================================
summary of summaries:

analyzed: ./tmp/tmp_smp.tg.spthy

  IRKTheftProofCareless (all-traces): falsified - found trace (5 steps)
  IRKTheftProofCareful (all-traces): verified (48 steps)

==============================================================================
maude tool: 'maude'
 checking version: 2.7.1. OK.
 checking installation: OK.

theory tmp_smp begin

// Function signature and definition of the equational theory E

functions: fst/1, pair/2, snd/1
equations: fst(<x.1, x.2>) = x.1, snd(<x.1, x.2>) = x.2



restriction tg_cell_neq_restriction:
  "¬(∃ x_69 #i_68. TgCellNeq( x_69, x_69 ) @ #i_68)"
  // safety formula

lemma IRKTheftProofCareless:
  all-traces
  "∀ pid #i_50 #k_51.
    ((Distribute_IdKey_41( pid ) @ #i_50) ∧
     (Careless_Implementation_43( pid ) @ #k_51)) ⇒
    (∃ #j_52. (User_Confirmation_40( pid ) @ #j_52) ∧ (#j_52 < #i_50))"
/*
guarded formula characterizing all counter-examples:
"∃ pid #i_50 #k_51.
  (Distribute_IdKey_41( pid ) @ #i_50) ∧
  (Careless_Implementation_43( pid ) @ #k_51)
 ∧
  ∀ #j_52. (User_Confirmation_40( pid ) @ #j_52) ⇒ ¬(#j_52 < #i_50)"
*/
simplify
solve( StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, pid.1>
       ) ▶₀ #k_51 )
  case NoInputNoOutput_Mitm_NoIrk_67_manyto72tomany_case_01
  solve( Distribute_IdKey_41( ~id_66 ) @ #i_50 )
    case NoInputNoOutput_Mitm_NoIrk_67_manyto76
    solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_50 )
      case NoInputNoOutput_Mitm_NoIrk_67_72to75to76
      SOLVED // trace found
    qed
  qed
qed

lemma IRKTheftProofCareful:
  all-traces
  "∀ pid #i_55 #k_56.
    ((Distribute_IdKey_41( pid ) @ #i_55) ∧
     (Careful_Implementation_42( pid ) @ #k_56)) ⇒
    (∃ #j_57. (User_Confirmation_40( pid ) @ #j_57) ∧ (#j_57 < #i_55))"
/*
guarded formula characterizing all counter-examples:
"∃ pid #i_55 #k_56.
  (Distribute_IdKey_41( pid ) @ #i_55) ∧
  (Careful_Implementation_42( pid ) @ #k_56)
 ∧
  ∀ #j_57. (User_Confirmation_40( pid ) @ #j_57) ⇒ ¬(#j_57 < #i_55)"
*/
simplify
solve( StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, pid.1>
       ) ▶₀ #k_56 )
  case NoInputNoOutput_Mitm_NoIrk_67_manyto72tomany_case_01
  solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
    case NoInputNoOutput_Mitm_NoIrk_67_manyto74
    by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
  next
    case NoInputNoOutput_Mitm_NoIrk_67_manyto76
    by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
  qed
next
  case NoInputNoOutput_Mitm_NoIrk_67_manyto72tomany_case_02
  solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
    case NoInputNoOutput_Mitm_NoIrk_67_manyto74
    by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
  next
    case NoInputNoOutput_Mitm_NoIrk_67_manyto76
    by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
  qed
next
  case NoInputNoOutput_Mitm_NoIrk_67_manyto72tomany_case_03
  solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
    case NoInputNoOutput_Mitm_NoIrk_67_manyto74
    by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
  next
    case NoInputNoOutput_Mitm_NoIrk_67_manyto76
    by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
  qed
next
  case NoInputNoOutput_Mitm_NoIrk_67_manyto72tomany_case_04
  solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
    case NoInputNoOutput_Mitm_NoIrk_67_manyto74
    by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
  next
    case NoInputNoOutput_Mitm_NoIrk_67_manyto76
    by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
  qed
next
  case NoInputNoOutput_Mitm_NoIrk_67_manyto72tomany_case_05
  solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
    case NoInputNoOutput_Mitm_NoIrk_67_manyto74
    by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
  next
    case NoInputNoOutput_Mitm_NoIrk_67_manyto76
    by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
  qed
next
  case NoInputNoOutput_Mitm_NoIrk_67_manyto72tomany_case_06
  solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
    case NoInputNoOutput_Mitm_NoIrk_67_manyto74
    by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
  next
    case NoInputNoOutput_Mitm_NoIrk_67_manyto76
    by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
  qed
next
  case NoInputNoOutput_Mitm_NoIrk_67_manyto72tomany_case_07
  solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
    case NoInputNoOutput_Mitm_NoIrk_67_manyto74
    by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
  next
    case NoInputNoOutput_Mitm_NoIrk_67_manyto76
    by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
  qed
next
  case NoInputNoOutput_Mitm_NoIrk_67_manyto72tomany_case_08
  solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
    case NoInputNoOutput_Mitm_NoIrk_67_manyto74
    by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
  next
    case NoInputNoOutput_Mitm_NoIrk_67_manyto76
    by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
  qed
next
  case NoInputNoOutput_Mitm_NoIrk_67_manyto72tomany_case_09
  solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
    case NoInputNoOutput_Mitm_NoIrk_67_manyto74
    by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
  next
    case NoInputNoOutput_Mitm_NoIrk_67_manyto76
    by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
  qed
next
  case NoInputNoOutput_Mitm_NoIrk_67_manyto72tomany_case_10
  solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
    case NoInputNoOutput_Mitm_NoIrk_67_manyto74
    by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
  next
    case NoInputNoOutput_Mitm_NoIrk_67_manyto76
    by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
  qed
qed

restriction either_careless_or_careful:
  "(∀ pid #i_60.
     (Careful_Implementation_42( pid ) @ #i_60) ⇒
     (¬(∃ #j_61. Careless_Implementation_43( pid ) @ #j_61))) ∧
   (∀ pid #i_63.
     (Careless_Implementation_43( pid ) @ #i_63) ⇒
     (¬(∃ #j_64. Careful_Implementation_42( pid ) @ #j_64)))"
  // safety formula

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_0to1:
   [ Fr( ~pid ) ] --> [ StF( ~pid, 'tgk1', 'empty_tuple' ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_manyto1to2:
   [ StF( ~pid, 'tgk1', 'empty_tuple' ), Fr( ~id_66 ) ]
  -->
   [ StF( ~pid, 'tgk2', <'False', 'NoInputNoOutput', 'True', ~id_66> ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_manyto2to3:
   [
   StF( ~pid, 'tgk2',
        <tgc_idkey_0, tgc_iocap_0, tgc_mitm_0, tgc_process_id_0>
   )
   ]
  -->
   [
   StF( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_mitm_0, tgc_process_id_0>
   ),
   Out( <'Pairing_Request', tgc_idkey_0, tgc_mitm_0, tgc_iocap_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_manyto3tomany:
   [
   StF( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_mitm_0, tgc_process_id_0>
   ),
   In( <'Pairing_Response', idkey_47, mitm_45, iocap_46> )
   ]
  -->
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, iocap_46, idkey_47, tgc_mitm_0, mitm_45, 
         tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_3to4to67:
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 'False', 
         'False', tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_3to5tomany:
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 'True', 
         tgc_mitm_b_0, tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_5to6tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_6to7to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_6to8to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_6to9to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_6to10to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_6to11to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_5to12tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayYesNo', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_12to13to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_12to14to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_12to15to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_12to16to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_12to17to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_5to18tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_18to19to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_18to20to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_18to21to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_18to22to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_18to23to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_5to24tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_24to25to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_24to26to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_24to27to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_24to28to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_24to29to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_5to30tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_30to31to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_30to32to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_30to33to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_30to34to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_30to35to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_3to36tomany:
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, tgc_mitm_0, 
         'True', tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_36to37tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_37to38to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_37to39to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_37to40to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_37to41to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_37to42to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_36to43tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayYesNo', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_43to44to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_43to45to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_43to46to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_43to47to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_43to48to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_36to49tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_49to50to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_49to51to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_49to52to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_49to53to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_49to54to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_36to55tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_55to56to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_55to57to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_55to58to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_55to59to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_55to60to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_36to61tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_61to62to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_61to63to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_61to64to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_61to65to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_61to66to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_67to68to70:
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, tgc_protocol_0>
   )
   ]
  --[ TgCellNeq( tgc_protocol_0, 'Just_Works' ) ]->
   [ StF( ~pid, 'tgk70', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_67to69to71:
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]
  -->
   [ StF( ~pid, 'tgk71', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_manyto70to72:
   [ StF( ~pid, 'tgk70', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  --[ User_Confirmation_40( tgc_process_id_0 ) ]->
   [ StF( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_manyto71to72:
   [ StF( ~pid, 'tgk71', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  -->
   [ StF( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_manyto72tomany:
   [ StF( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  -->
   [ StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_72to73to74:
   [ StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  --[ Careful_Implementation_42( tgc_process_id_0 ) ]->
   [ StF( ~pid, 'tgk74', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_72to75to76:
   [ StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  --[ Careless_Implementation_43( tgc_process_id_0 ) ]->
   [ StF( ~pid, 'tgk76', <tgc_irk_a_rsp_0, tgc_process_id_0> ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_manyto74:
   [ StF( ~pid, 'tgk74', <'True', 'True', tgc_process_id_0> ) ]
  --[ Distribute_IdKey_41( tgc_process_id_0 ) ]->
   [ ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_Mitm_NoIrk_67_manyto76:
   [ StF( ~pid, 'tgk76', <'True', tgc_process_id_0> ) ]
  --[ Distribute_IdKey_41( tgc_process_id_0 ) ]->
   [ ]

  /* has exactly the trivial AC variant */

/* All well-formedness checks were successful. */

end

==============================================================================
summary of summaries:

analyzed: ./tmp/tmp_smp.tg.spthy

  IRKTheftProofCareless (all-traces): falsified - found trace (5 steps)
  IRKTheftProofCareful (all-traces): verified (32 steps)

==============================================================================
maude tool: 'maude'
 checking version: 2.7.1. OK.
 checking installation: OK.

theory tmp_smp begin

// Function signature and definition of the equational theory E

functions: fst/1, pair/2, snd/1
equations: fst(<x.1, x.2>) = x.1, snd(<x.1, x.2>) = x.2



restriction tg_cell_neq_restriction:
  "¬(∃ x_69 #i_68. TgCellNeq( x_69, x_69 ) @ #i_68)"
  // safety formula

lemma IRKTheftProofCareless:
  all-traces
  "∀ pid #i_50 #k_51.
    ((Distribute_IdKey_41( pid ) @ #i_50) ∧
     (Careless_Implementation_43( pid ) @ #k_51)) ⇒
    (∃ #j_52. (User_Confirmation_40( pid ) @ #j_52) ∧ (#j_52 < #i_50))"
/*
guarded formula characterizing all counter-examples:
"∃ pid #i_50 #k_51.
  (Distribute_IdKey_41( pid ) @ #i_50) ∧
  (Careless_Implementation_43( pid ) @ #k_51)
 ∧
  ∀ #j_52. (User_Confirmation_40( pid ) @ #j_52) ⇒ ¬(#j_52 < #i_50)"
*/
simplify
solve( StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, pid.1>
       ) ▶₀ #k_51 )
  case KeyboardDisplay_Mitm_NoIrk_67_manyto72tomany_case_09
  solve( Distribute_IdKey_41( ~id_66 ) @ #i_50 )
    case KeyboardDisplay_Mitm_NoIrk_67_manyto76
    solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_50 )
      case KeyboardDisplay_Mitm_NoIrk_67_72to75to76
      SOLVED // trace found
    qed
  qed
qed

lemma IRKTheftProofCareful:
  all-traces
  "∀ pid #i_55 #k_56.
    ((Distribute_IdKey_41( pid ) @ #i_55) ∧
     (Careful_Implementation_42( pid ) @ #k_56)) ⇒
    (∃ #j_57. (User_Confirmation_40( pid ) @ #j_57) ∧ (#j_57 < #i_55))"
/*
guarded formula characterizing all counter-examples:
"∃ pid #i_55 #k_56.
  (Distribute_IdKey_41( pid ) @ #i_55) ∧
  (Careful_Implementation_42( pid ) @ #k_56)
 ∧
  ∀ #j_57. (User_Confirmation_40( pid ) @ #j_57) ⇒ ¬(#j_57 < #i_55)"
*/
simplify
solve( StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, pid.1>
       ) ▶₀ #k_56 )
  case KeyboardDisplay_Mitm_NoIrk_67_manyto72tomany_case_01
  solve( (#vr.1 = #i_55)  ∥ (#i_55 < #vr.1) )
    case case_1
    by solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
  next
    case case_2
    solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
      case KeyboardDisplay_Mitm_NoIrk_67_manyto74
      by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
    next
      case KeyboardDisplay_Mitm_NoIrk_67_manyto76
      by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
    qed
  qed
next
  case KeyboardDisplay_Mitm_NoIrk_67_manyto72tomany_case_02
  solve( (#vr.1 = #i_55)  ∥ (#i_55 < #vr.1) )
    case case_1
    by solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
  next
    case case_2
    solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
      case KeyboardDisplay_Mitm_NoIrk_67_manyto74
      by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
    next
      case KeyboardDisplay_Mitm_NoIrk_67_manyto76
      by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
    qed
  qed
next
  case KeyboardDisplay_Mitm_NoIrk_67_manyto72tomany_case_03
  solve( (#vr.1 = #i_55)  ∥ (#i_55 < #vr.1) )
    case case_1
    by solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
  next
    case case_2
    solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
      case KeyboardDisplay_Mitm_NoIrk_67_manyto74
      by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
    next
      case KeyboardDisplay_Mitm_NoIrk_67_manyto76
      by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
    qed
  qed
next
  case KeyboardDisplay_Mitm_NoIrk_67_manyto72tomany_case_04
  solve( (#vr.1 = #i_55)  ∥ (#i_55 < #vr.1) )
    case case_1
    by solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
  next
    case case_2
    solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
      case KeyboardDisplay_Mitm_NoIrk_67_manyto74
      by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
    next
      case KeyboardDisplay_Mitm_NoIrk_67_manyto76
      by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
    qed
  qed
next
  case KeyboardDisplay_Mitm_NoIrk_67_manyto72tomany_case_05
  solve( (#vr.1 = #i_55)  ∥ (#i_55 < #vr.1) )
    case case_1
    by solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
  next
    case case_2
    solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
      case KeyboardDisplay_Mitm_NoIrk_67_manyto74
      by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
    next
      case KeyboardDisplay_Mitm_NoIrk_67_manyto76
      by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
    qed
  qed
next
  case KeyboardDisplay_Mitm_NoIrk_67_manyto72tomany_case_06
  solve( (#vr.1 = #i_55)  ∥ (#i_55 < #vr.1) )
    case case_1
    by solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
  next
    case case_2
    solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
      case KeyboardDisplay_Mitm_NoIrk_67_manyto74
      by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
    next
      case KeyboardDisplay_Mitm_NoIrk_67_manyto76
      by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
    qed
  qed
next
  case KeyboardDisplay_Mitm_NoIrk_67_manyto72tomany_case_07
  solve( (#vr.1 = #i_55)  ∥ (#i_55 < #vr.1) )
    case case_1
    by solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
  next
    case case_2
    solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
      case KeyboardDisplay_Mitm_NoIrk_67_manyto74
      by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
    next
      case KeyboardDisplay_Mitm_NoIrk_67_manyto76
      by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
    qed
  qed
next
  case KeyboardDisplay_Mitm_NoIrk_67_manyto72tomany_case_08
  solve( (#vr.1 = #i_55)  ∥ (#i_55 < #vr.1) )
    case case_1
    by solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
  next
    case case_2
    solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
      case KeyboardDisplay_Mitm_NoIrk_67_manyto74
      by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
    next
      case KeyboardDisplay_Mitm_NoIrk_67_manyto76
      by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
    qed
  qed
next
  case KeyboardDisplay_Mitm_NoIrk_67_manyto72tomany_case_09
  solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
    case KeyboardDisplay_Mitm_NoIrk_67_manyto74
    by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
  next
    case KeyboardDisplay_Mitm_NoIrk_67_manyto76
    by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
  qed
next
  case KeyboardDisplay_Mitm_NoIrk_67_manyto72tomany_case_10
  solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
    case KeyboardDisplay_Mitm_NoIrk_67_manyto74
    by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
  next
    case KeyboardDisplay_Mitm_NoIrk_67_manyto76
    by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
  qed
qed

restriction either_careless_or_careful:
  "(∀ pid #i_60.
     (Careful_Implementation_42( pid ) @ #i_60) ⇒
     (¬(∃ #j_61. Careless_Implementation_43( pid ) @ #j_61))) ∧
   (∀ pid #i_63.
     (Careless_Implementation_43( pid ) @ #i_63) ⇒
     (¬(∃ #j_64. Careful_Implementation_42( pid ) @ #j_64)))"
  // safety formula

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_0to1:
   [ Fr( ~pid ) ] --> [ StF( ~pid, 'tgk1', 'empty_tuple' ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_manyto1to2:
   [ StF( ~pid, 'tgk1', 'empty_tuple' ), Fr( ~id_66 ) ]
  -->
   [ StF( ~pid, 'tgk2', <'False', 'KeyboardDisplay', 'True', ~id_66> ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_manyto2to3:
   [
   StF( ~pid, 'tgk2',
        <tgc_idkey_0, tgc_iocap_0, tgc_mitm_0, tgc_process_id_0>
   )
   ]
  -->
   [
   StF( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_mitm_0, tgc_process_id_0>
   ),
   Out( <'Pairing_Request', tgc_idkey_0, tgc_mitm_0, tgc_iocap_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_manyto3tomany:
   [
   StF( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_mitm_0, tgc_process_id_0>
   ),
   In( <'Pairing_Response', idkey_47, mitm_45, iocap_46> )
   ]
  -->
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, iocap_46, idkey_47, tgc_mitm_0, mitm_45, 
         tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_3to4to67:
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 'False', 
         'False', tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_3to5tomany:
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 'True', 
         tgc_mitm_b_0, tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_5to6tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_6to7to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_6to8to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_6to9to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_6to10to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_6to11to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_5to12tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayYesNo', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_12to13to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_12to14to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_12to15to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_12to16to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_12to17to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_5to18tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_18to19to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_18to20to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_18to21to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_18to22to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_18to23to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_5to24tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_24to25to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_24to26to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_24to27to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_24to28to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_24to29to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_5to30tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_30to31to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_30to32to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_30to33to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_30to34to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_30to35to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_3to36tomany:
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, tgc_mitm_0, 
         'True', tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_36to37tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_37to38to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_37to39to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_37to40to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_37to41to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_37to42to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_36to43tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayYesNo', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_43to44to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_43to45to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_43to46to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_43to47to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_43to48to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_36to49tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_49to50to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_49to51to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_49to52to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_49to53to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_49to54to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_36to55tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_55to56to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_55to57to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_55to58to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_55to59to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_55to60to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_36to61tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_61to62to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_61to63to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_61to64to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_61to65to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_61to66to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_67to68to70:
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, tgc_protocol_0>
   )
   ]
  --[ TgCellNeq( tgc_protocol_0, 'Just_Works' ) ]->
   [ StF( ~pid, 'tgk70', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_67to69to71:
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]
  -->
   [ StF( ~pid, 'tgk71', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_manyto70to72:
   [ StF( ~pid, 'tgk70', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  --[ User_Confirmation_40( tgc_process_id_0 ) ]->
   [ StF( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_manyto71to72:
   [ StF( ~pid, 'tgk71', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  -->
   [ StF( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_manyto72tomany:
   [ StF( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  -->
   [ StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_72to73to74:
   [ StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  --[ Careful_Implementation_42( tgc_process_id_0 ) ]->
   [ StF( ~pid, 'tgk74', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_72to75to76:
   [ StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  --[ Careless_Implementation_43( tgc_process_id_0 ) ]->
   [ StF( ~pid, 'tgk76', <tgc_irk_a_rsp_0, tgc_process_id_0> ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_manyto74:
   [ StF( ~pid, 'tgk74', <'True', 'True', tgc_process_id_0> ) ]
  --[ Distribute_IdKey_41( tgc_process_id_0 ) ]->
   [ ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_Mitm_NoIrk_67_manyto76:
   [ StF( ~pid, 'tgk76', <'True', tgc_process_id_0> ) ]
  --[ Distribute_IdKey_41( tgc_process_id_0 ) ]->
   [ ]

  /* has exactly the trivial AC variant */

/* All well-formedness checks were successful. */

end

==============================================================================
summary of summaries:

analyzed: ./tmp/tmp_smp.tg.spthy

  IRKTheftProofCareless (all-traces): falsified - found trace (5 steps)
  IRKTheftProofCareful (all-traces): verified (48 steps)

==============================================================================
maude tool: 'maude'
 checking version: 2.7.1. OK.
 checking installation: OK.

theory tmp_smp begin

// Function signature and definition of the equational theory E

functions: fst/1, pair/2, snd/1
equations: fst(<x.1, x.2>) = x.1, snd(<x.1, x.2>) = x.2



restriction tg_cell_neq_restriction:
  "¬(∃ x_69 #i_68. TgCellNeq( x_69, x_69 ) @ #i_68)"
  // safety formula

lemma IRKTheftProofCareless:
  all-traces
  "∀ pid #i_50 #k_51.
    ((Distribute_IdKey_41( pid ) @ #i_50) ∧
     (Careless_Implementation_43( pid ) @ #k_51)) ⇒
    (∃ #j_52. (User_Confirmation_40( pid ) @ #j_52) ∧ (#j_52 < #i_50))"
/*
guarded formula characterizing all counter-examples:
"∃ pid #i_50 #k_51.
  (Distribute_IdKey_41( pid ) @ #i_50) ∧
  (Careless_Implementation_43( pid ) @ #k_51)
 ∧
  ∀ #j_52. (User_Confirmation_40( pid ) @ #j_52) ⇒ ¬(#j_52 < #i_50)"
*/
simplify
solve( StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, pid.1>
       ) ▶₀ #k_51 )
  case DisplayOnly_NoMitm_NoIrk_67_manyto72tomany_case_3
  solve( Distribute_IdKey_41( ~id_66 ) @ #i_50 )
    case DisplayOnly_NoMitm_NoIrk_67_manyto76
    solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_50 )
      case DisplayOnly_NoMitm_NoIrk_67_72to75to76
      SOLVED // trace found
    qed
  qed
qed

lemma IRKTheftProofCareful:
  all-traces
  "∀ pid #i_55 #k_56.
    ((Distribute_IdKey_41( pid ) @ #i_55) ∧
     (Careful_Implementation_42( pid ) @ #k_56)) ⇒
    (∃ #j_57. (User_Confirmation_40( pid ) @ #j_57) ∧ (#j_57 < #i_55))"
/*
guarded formula characterizing all counter-examples:
"∃ pid #i_55 #k_56.
  (Distribute_IdKey_41( pid ) @ #i_55) ∧
  (Careful_Implementation_42( pid ) @ #k_56)
 ∧
  ∀ #j_57. (User_Confirmation_40( pid ) @ #j_57) ⇒ ¬(#j_57 < #i_55)"
*/
simplify
solve( StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, pid.1>
       ) ▶₀ #k_56 )
  case DisplayOnly_NoMitm_NoIrk_67_manyto72tomany_case_1
  solve( (#vr.1 = #i_55)  ∥ (#i_55 < #vr.1) )
    case case_1
    by solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
  next
    case case_2
    solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
      case DisplayOnly_NoMitm_NoIrk_67_manyto74
      by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
    next
      case DisplayOnly_NoMitm_NoIrk_67_manyto76
      by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
    qed
  qed
next
  case DisplayOnly_NoMitm_NoIrk_67_manyto72tomany_case_2
  solve( (#vr.1 = #i_55)  ∥ (#i_55 < #vr.1) )
    case case_1
    by solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
  next
    case case_2
    solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
      case DisplayOnly_NoMitm_NoIrk_67_manyto74
      by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
    next
      case DisplayOnly_NoMitm_NoIrk_67_manyto76
      by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
    qed
  qed
next
  case DisplayOnly_NoMitm_NoIrk_67_manyto72tomany_case_3
  solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
    case DisplayOnly_NoMitm_NoIrk_67_manyto74
    by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
  next
    case DisplayOnly_NoMitm_NoIrk_67_manyto76
    by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
  qed
next
  case DisplayOnly_NoMitm_NoIrk_67_manyto72tomany_case_4
  solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
    case DisplayOnly_NoMitm_NoIrk_67_manyto74
    by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
  next
    case DisplayOnly_NoMitm_NoIrk_67_manyto76
    by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
  qed
next
  case DisplayOnly_NoMitm_NoIrk_67_manyto72tomany_case_5
  solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
    case DisplayOnly_NoMitm_NoIrk_67_manyto74
    by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
  next
    case DisplayOnly_NoMitm_NoIrk_67_manyto76
    by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
  qed
next
  case DisplayOnly_NoMitm_NoIrk_67_manyto72tomany_case_6
  solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
    case DisplayOnly_NoMitm_NoIrk_67_manyto74
    by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
  next
    case DisplayOnly_NoMitm_NoIrk_67_manyto76
    by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
  qed
qed

restriction either_careless_or_careful:
  "(∀ pid #i_60.
     (Careful_Implementation_42( pid ) @ #i_60) ⇒
     (¬(∃ #j_61. Careless_Implementation_43( pid ) @ #j_61))) ∧
   (∀ pid #i_63.
     (Careless_Implementation_43( pid ) @ #i_63) ⇒
     (¬(∃ #j_64. Careful_Implementation_42( pid ) @ #j_64)))"
  // safety formula

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_0to1:
   [ Fr( ~pid ) ] --> [ StF( ~pid, 'tgk1', 'empty_tuple' ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_manyto1to2:
   [ StF( ~pid, 'tgk1', 'empty_tuple' ), Fr( ~id_66 ) ]
  -->
   [ StF( ~pid, 'tgk2', <'False', 'DisplayOnly', 'False', ~id_66> ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_manyto2to3:
   [
   StF( ~pid, 'tgk2',
        <tgc_idkey_0, tgc_iocap_0, tgc_mitm_0, tgc_process_id_0>
   )
   ]
  -->
   [
   StF( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_mitm_0, tgc_process_id_0>
   ),
   Out( <'Pairing_Request', tgc_idkey_0, tgc_mitm_0, tgc_iocap_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_manyto3tomany:
   [
   StF( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_mitm_0, tgc_process_id_0>
   ),
   In( <'Pairing_Response', idkey_47, mitm_45, iocap_46> )
   ]
  -->
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, iocap_46, idkey_47, tgc_mitm_0, mitm_45, 
         tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_3to4to67:
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 'False', 
         'False', tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_3to5tomany:
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 'True', 
         tgc_mitm_b_0, tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_5to6tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_6to7to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_6to8to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_6to9to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_6to10to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_6to11to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_5to12tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayYesNo', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_12to13to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_12to14to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_12to15to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_12to16to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_12to17to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_5to18tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_18to19to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_18to20to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_18to21to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_18to22to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_18to23to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_5to24tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_24to25to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_24to26to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_24to27to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_24to28to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_24to29to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_5to30tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_30to31to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_30to32to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_30to33to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_30to34to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_30to35to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_3to36tomany:
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, tgc_mitm_0, 
         'True', tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_36to37tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_37to38to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_37to39to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_37to40to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_37to41to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_37to42to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_36to43tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayYesNo', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_43to44to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_43to45to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_43to46to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_43to47to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_43to48to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_36to49tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_49to50to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_49to51to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_49to52to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_49to53to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_49to54to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_36to55tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_55to56to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_55to57to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_55to58to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_55to59to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_55to60to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_36to61tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_61to62to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_61to63to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_61to64to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_61to65to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_61to66to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_67to68to70:
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, tgc_protocol_0>
   )
   ]
  --[ TgCellNeq( tgc_protocol_0, 'Just_Works' ) ]->
   [ StF( ~pid, 'tgk70', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_67to69to71:
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]
  -->
   [ StF( ~pid, 'tgk71', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_manyto70to72:
   [ StF( ~pid, 'tgk70', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  --[ User_Confirmation_40( tgc_process_id_0 ) ]->
   [ StF( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_manyto71to72:
   [ StF( ~pid, 'tgk71', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  -->
   [ StF( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_manyto72tomany:
   [ StF( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  -->
   [ StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_72to73to74:
   [ StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  --[ Careful_Implementation_42( tgc_process_id_0 ) ]->
   [ StF( ~pid, 'tgk74', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_72to75to76:
   [ StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  --[ Careless_Implementation_43( tgc_process_id_0 ) ]->
   [ StF( ~pid, 'tgk76', <tgc_irk_a_rsp_0, tgc_process_id_0> ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_manyto74:
   [ StF( ~pid, 'tgk74', <'True', 'True', tgc_process_id_0> ) ]
  --[ Distribute_IdKey_41( tgc_process_id_0 ) ]->
   [ ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayOnly_NoMitm_NoIrk_67_manyto76:
   [ StF( ~pid, 'tgk76', <'True', tgc_process_id_0> ) ]
  --[ Distribute_IdKey_41( tgc_process_id_0 ) ]->
   [ ]

  /* has exactly the trivial AC variant */

/* All well-formedness checks were successful. */

end

==============================================================================
summary of summaries:

analyzed: ./tmp/tmp_smp.tg.spthy

  IRKTheftProofCareless (all-traces): falsified - found trace (5 steps)
  IRKTheftProofCareful (all-traces): verified (24 steps)

==============================================================================
maude tool: 'maude'
 checking version: 2.7.1. OK.
 checking installation: OK.

theory tmp_smp begin

// Function signature and definition of the equational theory E

functions: fst/1, pair/2, snd/1
equations: fst(<x.1, x.2>) = x.1, snd(<x.1, x.2>) = x.2



restriction tg_cell_neq_restriction:
  "¬(∃ x_69 #i_68. TgCellNeq( x_69, x_69 ) @ #i_68)"
  // safety formula

lemma IRKTheftProofCareless:
  all-traces
  "∀ pid #i_50 #k_51.
    ((Distribute_IdKey_41( pid ) @ #i_50) ∧
     (Careless_Implementation_43( pid ) @ #k_51)) ⇒
    (∃ #j_52. (User_Confirmation_40( pid ) @ #j_52) ∧ (#j_52 < #i_50))"
/*
guarded formula characterizing all counter-examples:
"∃ pid #i_50 #k_51.
  (Distribute_IdKey_41( pid ) @ #i_50) ∧
  (Careless_Implementation_43( pid ) @ #k_51)
 ∧
  ∀ #j_52. (User_Confirmation_40( pid ) @ #j_52) ⇒ ¬(#j_52 < #i_50)"
*/
simplify
solve( StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, pid.1>
       ) ▶₀ #k_51 )
  case DisplayYesNo_NoMitm_NoIrk_67_manyto72tomany_case_4
  solve( Distribute_IdKey_41( ~id_66 ) @ #i_50 )
    case DisplayYesNo_NoMitm_NoIrk_67_manyto76
    solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_50 )
      case DisplayYesNo_NoMitm_NoIrk_67_72to75to76
      SOLVED // trace found
    qed
  qed
qed

lemma IRKTheftProofCareful:
  all-traces
  "∀ pid #i_55 #k_56.
    ((Distribute_IdKey_41( pid ) @ #i_55) ∧
     (Careful_Implementation_42( pid ) @ #k_56)) ⇒
    (∃ #j_57. (User_Confirmation_40( pid ) @ #j_57) ∧ (#j_57 < #i_55))"
/*
guarded formula characterizing all counter-examples:
"∃ pid #i_55 #k_56.
  (Distribute_IdKey_41( pid ) @ #i_55) ∧
  (Careful_Implementation_42( pid ) @ #k_56)
 ∧
  ∀ #j_57. (User_Confirmation_40( pid ) @ #j_57) ⇒ ¬(#j_57 < #i_55)"
*/
simplify
solve( StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, pid.1>
       ) ▶₀ #k_56 )
  case DisplayYesNo_NoMitm_NoIrk_67_manyto72tomany_case_1
  solve( (#vr.1 = #i_55)  ∥ (#i_55 < #vr.1) )
    case case_1
    by solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
  next
    case case_2
    solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
      case DisplayYesNo_NoMitm_NoIrk_67_manyto74
      by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
    next
      case DisplayYesNo_NoMitm_NoIrk_67_manyto76
      by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
    qed
  qed
next
  case DisplayYesNo_NoMitm_NoIrk_67_manyto72tomany_case_2
  solve( (#vr.1 = #i_55)  ∥ (#i_55 < #vr.1) )
    case case_1
    by solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
  next
    case case_2
    solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
      case DisplayYesNo_NoMitm_NoIrk_67_manyto74
      by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
    next
      case DisplayYesNo_NoMitm_NoIrk_67_manyto76
      by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
    qed
  qed
next
  case DisplayYesNo_NoMitm_NoIrk_67_manyto72tomany_case_3
  solve( (#vr.1 = #i_55)  ∥ (#i_55 < #vr.1) )
    case case_1
    by solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
  next
    case case_2
    solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
      case DisplayYesNo_NoMitm_NoIrk_67_manyto74
      by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
    next
      case DisplayYesNo_NoMitm_NoIrk_67_manyto76
      by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
    qed
  qed
next
  case DisplayYesNo_NoMitm_NoIrk_67_manyto72tomany_case_4
  solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
    case DisplayYesNo_NoMitm_NoIrk_67_manyto74
    by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
  next
    case DisplayYesNo_NoMitm_NoIrk_67_manyto76
    by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
  qed
next
  case DisplayYesNo_NoMitm_NoIrk_67_manyto72tomany_case_5
  solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
    case DisplayYesNo_NoMitm_NoIrk_67_manyto74
    by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
  next
    case DisplayYesNo_NoMitm_NoIrk_67_manyto76
    by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
  qed
next
  case DisplayYesNo_NoMitm_NoIrk_67_manyto72tomany_case_6
  solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
    case DisplayYesNo_NoMitm_NoIrk_67_manyto74
    by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
  next
    case DisplayYesNo_NoMitm_NoIrk_67_manyto76
    by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
  qed
qed

restriction either_careless_or_careful:
  "(∀ pid #i_60.
     (Careful_Implementation_42( pid ) @ #i_60) ⇒
     (¬(∃ #j_61. Careless_Implementation_43( pid ) @ #j_61))) ∧
   (∀ pid #i_63.
     (Careless_Implementation_43( pid ) @ #i_63) ⇒
     (¬(∃ #j_64. Careful_Implementation_42( pid ) @ #j_64)))"
  // safety formula

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_0to1:
   [ Fr( ~pid ) ] --> [ StF( ~pid, 'tgk1', 'empty_tuple' ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_manyto1to2:
   [ StF( ~pid, 'tgk1', 'empty_tuple' ), Fr( ~id_66 ) ]
  -->
   [ StF( ~pid, 'tgk2', <'False', 'DisplayYesNo', 'False', ~id_66> ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_manyto2to3:
   [
   StF( ~pid, 'tgk2',
        <tgc_idkey_0, tgc_iocap_0, tgc_mitm_0, tgc_process_id_0>
   )
   ]
  -->
   [
   StF( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_mitm_0, tgc_process_id_0>
   ),
   Out( <'Pairing_Request', tgc_idkey_0, tgc_mitm_0, tgc_iocap_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_manyto3tomany:
   [
   StF( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_mitm_0, tgc_process_id_0>
   ),
   In( <'Pairing_Response', idkey_47, mitm_45, iocap_46> )
   ]
  -->
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, iocap_46, idkey_47, tgc_mitm_0, mitm_45, 
         tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_3to4to67:
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 'False', 
         'False', tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_3to5tomany:
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 'True', 
         tgc_mitm_b_0, tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_5to6tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_6to7to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_6to8to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_6to9to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_6to10to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_6to11to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_5to12tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayYesNo', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_12to13to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_12to14to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_12to15to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_12to16to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_12to17to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_5to18tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_18to19to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_18to20to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_18to21to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_18to22to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_18to23to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_5to24tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_24to25to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_24to26to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_24to27to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_24to28to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_24to29to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_5to30tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_30to31to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_30to32to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_30to33to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_30to34to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_30to35to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_3to36tomany:
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, tgc_mitm_0, 
         'True', tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_36to37tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_37to38to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_37to39to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_37to40to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_37to41to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_37to42to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_36to43tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayYesNo', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_43to44to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_43to45to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_43to46to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_43to47to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_43to48to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_36to49tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_49to50to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_49to51to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_49to52to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_49to53to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_49to54to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_36to55tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_55to56to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_55to57to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_55to58to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_55to59to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_55to60to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_36to61tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_61to62to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_61to63to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_61to64to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_61to65to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_61to66to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_67to68to70:
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, tgc_protocol_0>
   )
   ]
  --[ TgCellNeq( tgc_protocol_0, 'Just_Works' ) ]->
   [ StF( ~pid, 'tgk70', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_67to69to71:
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]
  -->
   [ StF( ~pid, 'tgk71', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_manyto70to72:
   [ StF( ~pid, 'tgk70', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  --[ User_Confirmation_40( tgc_process_id_0 ) ]->
   [ StF( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_manyto71to72:
   [ StF( ~pid, 'tgk71', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  -->
   [ StF( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_manyto72tomany:
   [ StF( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  -->
   [ StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_72to73to74:
   [ StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  --[ Careful_Implementation_42( tgc_process_id_0 ) ]->
   [ StF( ~pid, 'tgk74', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_72to75to76:
   [ StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  --[ Careless_Implementation_43( tgc_process_id_0 ) ]->
   [ StF( ~pid, 'tgk76', <tgc_irk_a_rsp_0, tgc_process_id_0> ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_manyto74:
   [ StF( ~pid, 'tgk74', <'True', 'True', tgc_process_id_0> ) ]
  --[ Distribute_IdKey_41( tgc_process_id_0 ) ]->
   [ ]

  /* has exactly the trivial AC variant */

rule (modulo E) DisplayYesNo_NoMitm_NoIrk_67_manyto76:
   [ StF( ~pid, 'tgk76', <'True', tgc_process_id_0> ) ]
  --[ Distribute_IdKey_41( tgc_process_id_0 ) ]->
   [ ]

  /* has exactly the trivial AC variant */

/* All well-formedness checks were successful. */

end

==============================================================================
summary of summaries:

analyzed: ./tmp/tmp_smp.tg.spthy

  IRKTheftProofCareless (all-traces): falsified - found trace (5 steps)
  IRKTheftProofCareful (all-traces): verified (26 steps)

==============================================================================
maude tool: 'maude'
 checking version: 2.7.1. OK.
 checking installation: OK.

theory tmp_smp begin

// Function signature and definition of the equational theory E

functions: fst/1, pair/2, snd/1
equations: fst(<x.1, x.2>) = x.1, snd(<x.1, x.2>) = x.2



restriction tg_cell_neq_restriction:
  "¬(∃ x_69 #i_68. TgCellNeq( x_69, x_69 ) @ #i_68)"
  // safety formula

lemma IRKTheftProofCareless:
  all-traces
  "∀ pid #i_50 #k_51.
    ((Distribute_IdKey_41( pid ) @ #i_50) ∧
     (Careless_Implementation_43( pid ) @ #k_51)) ⇒
    (∃ #j_52. (User_Confirmation_40( pid ) @ #j_52) ∧ (#j_52 < #i_50))"
/*
guarded formula characterizing all counter-examples:
"∃ pid #i_50 #k_51.
  (Distribute_IdKey_41( pid ) @ #i_50) ∧
  (Careless_Implementation_43( pid ) @ #k_51)
 ∧
  ∀ #j_52. (User_Confirmation_40( pid ) @ #j_52) ⇒ ¬(#j_52 < #i_50)"
*/
simplify
solve( StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, pid.1>
       ) ▶₀ #k_51 )
  case KeyboardOnly_NoMitm_NoIrk_67_manyto72tomany_case_5
  solve( Distribute_IdKey_41( ~id_66 ) @ #i_50 )
    case KeyboardOnly_NoMitm_NoIrk_67_manyto76
    solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_50 )
      case KeyboardOnly_NoMitm_NoIrk_67_72to75to76
      SOLVED // trace found
    qed
  qed
qed

lemma IRKTheftProofCareful:
  all-traces
  "∀ pid #i_55 #k_56.
    ((Distribute_IdKey_41( pid ) @ #i_55) ∧
     (Careful_Implementation_42( pid ) @ #k_56)) ⇒
    (∃ #j_57. (User_Confirmation_40( pid ) @ #j_57) ∧ (#j_57 < #i_55))"
/*
guarded formula characterizing all counter-examples:
"∃ pid #i_55 #k_56.
  (Distribute_IdKey_41( pid ) @ #i_55) ∧
  (Careful_Implementation_42( pid ) @ #k_56)
 ∧
  ∀ #j_57. (User_Confirmation_40( pid ) @ #j_57) ⇒ ¬(#j_57 < #i_55)"
*/
simplify
solve( StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, pid.1>
       ) ▶₀ #k_56 )
  case KeyboardOnly_NoMitm_NoIrk_67_manyto72tomany_case_1
  solve( (#vr.1 = #i_55)  ∥ (#i_55 < #vr.1) )
    case case_1
    by solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
  next
    case case_2
    solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
      case KeyboardOnly_NoMitm_NoIrk_67_manyto74
      by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
    next
      case KeyboardOnly_NoMitm_NoIrk_67_manyto76
      by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
    qed
  qed
next
  case KeyboardOnly_NoMitm_NoIrk_67_manyto72tomany_case_2
  solve( (#vr.1 = #i_55)  ∥ (#i_55 < #vr.1) )
    case case_1
    by solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
  next
    case case_2
    solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
      case KeyboardOnly_NoMitm_NoIrk_67_manyto74
      by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
    next
      case KeyboardOnly_NoMitm_NoIrk_67_manyto76
      by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
    qed
  qed
next
  case KeyboardOnly_NoMitm_NoIrk_67_manyto72tomany_case_3
  solve( (#vr.1 = #i_55)  ∥ (#i_55 < #vr.1) )
    case case_1
    by solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
  next
    case case_2
    solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
      case KeyboardOnly_NoMitm_NoIrk_67_manyto74
      by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
    next
      case KeyboardOnly_NoMitm_NoIrk_67_manyto76
      by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
    qed
  qed
next
  case KeyboardOnly_NoMitm_NoIrk_67_manyto72tomany_case_4
  solve( (#vr.1 = #i_55)  ∥ (#i_55 < #vr.1) )
    case case_1
    by solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
  next
    case case_2
    solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
      case KeyboardOnly_NoMitm_NoIrk_67_manyto74
      by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
    next
      case KeyboardOnly_NoMitm_NoIrk_67_manyto76
      by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
    qed
  qed
next
  case KeyboardOnly_NoMitm_NoIrk_67_manyto72tomany_case_5
  solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
    case KeyboardOnly_NoMitm_NoIrk_67_manyto74
    by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
  next
    case KeyboardOnly_NoMitm_NoIrk_67_manyto76
    by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
  qed
next
  case KeyboardOnly_NoMitm_NoIrk_67_manyto72tomany_case_6
  solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
    case KeyboardOnly_NoMitm_NoIrk_67_manyto74
    by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
  next
    case KeyboardOnly_NoMitm_NoIrk_67_manyto76
    by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
  qed
qed

restriction either_careless_or_careful:
  "(∀ pid #i_60.
     (Careful_Implementation_42( pid ) @ #i_60) ⇒
     (¬(∃ #j_61. Careless_Implementation_43( pid ) @ #j_61))) ∧
   (∀ pid #i_63.
     (Careless_Implementation_43( pid ) @ #i_63) ⇒
     (¬(∃ #j_64. Careful_Implementation_42( pid ) @ #j_64)))"
  // safety formula

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_0to1:
   [ Fr( ~pid ) ] --> [ StF( ~pid, 'tgk1', 'empty_tuple' ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_manyto1to2:
   [ StF( ~pid, 'tgk1', 'empty_tuple' ), Fr( ~id_66 ) ]
  -->
   [ StF( ~pid, 'tgk2', <'False', 'KeyboardOnly', 'False', ~id_66> ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_manyto2to3:
   [
   StF( ~pid, 'tgk2',
        <tgc_idkey_0, tgc_iocap_0, tgc_mitm_0, tgc_process_id_0>
   )
   ]
  -->
   [
   StF( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_mitm_0, tgc_process_id_0>
   ),
   Out( <'Pairing_Request', tgc_idkey_0, tgc_mitm_0, tgc_iocap_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_manyto3tomany:
   [
   StF( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_mitm_0, tgc_process_id_0>
   ),
   In( <'Pairing_Response', idkey_47, mitm_45, iocap_46> )
   ]
  -->
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, iocap_46, idkey_47, tgc_mitm_0, mitm_45, 
         tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_3to4to67:
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 'False', 
         'False', tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_3to5tomany:
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 'True', 
         tgc_mitm_b_0, tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_5to6tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_6to7to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_6to8to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_6to9to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_6to10to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_6to11to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_5to12tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayYesNo', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_12to13to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_12to14to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_12to15to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_12to16to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_12to17to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_5to18tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_18to19to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_18to20to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_18to21to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_18to22to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_18to23to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_5to24tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_24to25to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_24to26to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_24to27to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_24to28to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_24to29to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_5to30tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_30to31to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_30to32to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_30to33to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_30to34to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_30to35to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_3to36tomany:
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, tgc_mitm_0, 
         'True', tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_36to37tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_37to38to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_37to39to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_37to40to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_37to41to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_37to42to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_36to43tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayYesNo', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_43to44to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_43to45to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_43to46to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_43to47to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_43to48to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_36to49tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_49to50to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_49to51to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_49to52to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_49to53to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_49to54to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_36to55tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_55to56to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_55to57to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_55to58to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_55to59to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_55to60to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_36to61tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_61to62to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_61to63to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_61to64to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_61to65to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_61to66to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_67to68to70:
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, tgc_protocol_0>
   )
   ]
  --[ TgCellNeq( tgc_protocol_0, 'Just_Works' ) ]->
   [ StF( ~pid, 'tgk70', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_67to69to71:
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]
  -->
   [ StF( ~pid, 'tgk71', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_manyto70to72:
   [ StF( ~pid, 'tgk70', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  --[ User_Confirmation_40( tgc_process_id_0 ) ]->
   [ StF( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_manyto71to72:
   [ StF( ~pid, 'tgk71', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  -->
   [ StF( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_manyto72tomany:
   [ StF( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  -->
   [ StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_72to73to74:
   [ StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  --[ Careful_Implementation_42( tgc_process_id_0 ) ]->
   [ StF( ~pid, 'tgk74', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_72to75to76:
   [ StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  --[ Careless_Implementation_43( tgc_process_id_0 ) ]->
   [ StF( ~pid, 'tgk76', <tgc_irk_a_rsp_0, tgc_process_id_0> ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_manyto74:
   [ StF( ~pid, 'tgk74', <'True', 'True', tgc_process_id_0> ) ]
  --[ Distribute_IdKey_41( tgc_process_id_0 ) ]->
   [ ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardOnly_NoMitm_NoIrk_67_manyto76:
   [ StF( ~pid, 'tgk76', <'True', tgc_process_id_0> ) ]
  --[ Distribute_IdKey_41( tgc_process_id_0 ) ]->
   [ ]

  /* has exactly the trivial AC variant */

/* All well-formedness checks were successful. */

end

==============================================================================
summary of summaries:

analyzed: ./tmp/tmp_smp.tg.spthy

  IRKTheftProofCareless (all-traces): falsified - found trace (5 steps)
  IRKTheftProofCareful (all-traces): verified (28 steps)

==============================================================================
maude tool: 'maude'
 checking version: 2.7.1. OK.
 checking installation: OK.

theory tmp_smp begin

// Function signature and definition of the equational theory E

functions: fst/1, pair/2, snd/1
equations: fst(<x.1, x.2>) = x.1, snd(<x.1, x.2>) = x.2



restriction tg_cell_neq_restriction:
  "¬(∃ x_69 #i_68. TgCellNeq( x_69, x_69 ) @ #i_68)"
  // safety formula

lemma IRKTheftProofCareless:
  all-traces
  "∀ pid #i_50 #k_51.
    ((Distribute_IdKey_41( pid ) @ #i_50) ∧
     (Careless_Implementation_43( pid ) @ #k_51)) ⇒
    (∃ #j_52. (User_Confirmation_40( pid ) @ #j_52) ∧ (#j_52 < #i_50))"
/*
guarded formula characterizing all counter-examples:
"∃ pid #i_50 #k_51.
  (Distribute_IdKey_41( pid ) @ #i_50) ∧
  (Careless_Implementation_43( pid ) @ #k_51)
 ∧
  ∀ #j_52. (User_Confirmation_40( pid ) @ #j_52) ⇒ ¬(#j_52 < #i_50)"
*/
simplify
solve( StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, pid.1>
       ) ▶₀ #k_51 )
  case NoInputNoOutput_NoMitm_NoIrk_67_manyto72tomany_case_1
  solve( Distribute_IdKey_41( ~id_66 ) @ #i_50 )
    case NoInputNoOutput_NoMitm_NoIrk_67_manyto76
    solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_50 )
      case NoInputNoOutput_NoMitm_NoIrk_67_72to75to76
      SOLVED // trace found
    qed
  qed
qed

lemma IRKTheftProofCareful:
  all-traces
  "∀ pid #i_55 #k_56.
    ((Distribute_IdKey_41( pid ) @ #i_55) ∧
     (Careful_Implementation_42( pid ) @ #k_56)) ⇒
    (∃ #j_57. (User_Confirmation_40( pid ) @ #j_57) ∧ (#j_57 < #i_55))"
/*
guarded formula characterizing all counter-examples:
"∃ pid #i_55 #k_56.
  (Distribute_IdKey_41( pid ) @ #i_55) ∧
  (Careful_Implementation_42( pid ) @ #k_56)
 ∧
  ∀ #j_57. (User_Confirmation_40( pid ) @ #j_57) ⇒ ¬(#j_57 < #i_55)"
*/
simplify
solve( StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, pid.1>
       ) ▶₀ #k_56 )
  case NoInputNoOutput_NoMitm_NoIrk_67_manyto72tomany_case_1
  solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
    case NoInputNoOutput_NoMitm_NoIrk_67_manyto74
    by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
  next
    case NoInputNoOutput_NoMitm_NoIrk_67_manyto76
    by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
  qed
next
  case NoInputNoOutput_NoMitm_NoIrk_67_manyto72tomany_case_2
  solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
    case NoInputNoOutput_NoMitm_NoIrk_67_manyto74
    by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
  next
    case NoInputNoOutput_NoMitm_NoIrk_67_manyto76
    by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
  qed
next
  case NoInputNoOutput_NoMitm_NoIrk_67_manyto72tomany_case_3
  solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
    case NoInputNoOutput_NoMitm_NoIrk_67_manyto74
    by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
  next
    case NoInputNoOutput_NoMitm_NoIrk_67_manyto76
    by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
  qed
next
  case NoInputNoOutput_NoMitm_NoIrk_67_manyto72tomany_case_4
  solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
    case NoInputNoOutput_NoMitm_NoIrk_67_manyto74
    by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
  next
    case NoInputNoOutput_NoMitm_NoIrk_67_manyto76
    by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
  qed
next
  case NoInputNoOutput_NoMitm_NoIrk_67_manyto72tomany_case_5
  solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
    case NoInputNoOutput_NoMitm_NoIrk_67_manyto74
    by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
  next
    case NoInputNoOutput_NoMitm_NoIrk_67_manyto76
    by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
  qed
next
  case NoInputNoOutput_NoMitm_NoIrk_67_manyto72tomany_case_6
  solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
    case NoInputNoOutput_NoMitm_NoIrk_67_manyto74
    by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
  next
    case NoInputNoOutput_NoMitm_NoIrk_67_manyto76
    by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
  qed
qed

restriction either_careless_or_careful:
  "(∀ pid #i_60.
     (Careful_Implementation_42( pid ) @ #i_60) ⇒
     (¬(∃ #j_61. Careless_Implementation_43( pid ) @ #j_61))) ∧
   (∀ pid #i_63.
     (Careless_Implementation_43( pid ) @ #i_63) ⇒
     (¬(∃ #j_64. Careful_Implementation_42( pid ) @ #j_64)))"
  // safety formula

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_0to1:
   [ Fr( ~pid ) ] --> [ StF( ~pid, 'tgk1', 'empty_tuple' ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_manyto1to2:
   [ StF( ~pid, 'tgk1', 'empty_tuple' ), Fr( ~id_66 ) ]
  -->
   [ StF( ~pid, 'tgk2', <'False', 'NoInputNoOutput', 'False', ~id_66> ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_manyto2to3:
   [
   StF( ~pid, 'tgk2',
        <tgc_idkey_0, tgc_iocap_0, tgc_mitm_0, tgc_process_id_0>
   )
   ]
  -->
   [
   StF( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_mitm_0, tgc_process_id_0>
   ),
   Out( <'Pairing_Request', tgc_idkey_0, tgc_mitm_0, tgc_iocap_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_manyto3tomany:
   [
   StF( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_mitm_0, tgc_process_id_0>
   ),
   In( <'Pairing_Response', idkey_47, mitm_45, iocap_46> )
   ]
  -->
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, iocap_46, idkey_47, tgc_mitm_0, mitm_45, 
         tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_3to4to67:
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 'False', 
         'False', tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_3to5tomany:
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 'True', 
         tgc_mitm_b_0, tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_5to6tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_6to7to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_6to8to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_6to9to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_6to10to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_6to11to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_5to12tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayYesNo', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_12to13to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_12to14to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_12to15to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_12to16to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_12to17to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_5to18tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_18to19to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_18to20to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_18to21to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_18to22to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_18to23to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_5to24tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_24to25to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_24to26to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_24to27to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_24to28to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_24to29to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_5to30tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_30to31to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_30to32to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_30to33to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_30to34to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_30to35to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_3to36tomany:
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, tgc_mitm_0, 
         'True', tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_36to37tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_37to38to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_37to39to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_37to40to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_37to41to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_37to42to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_36to43tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayYesNo', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_43to44to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_43to45to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_43to46to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_43to47to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_43to48to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_36to49tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_49to50to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_49to51to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_49to52to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_49to53to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_49to54to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_36to55tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_55to56to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_55to57to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_55to58to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_55to59to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_55to60to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_36to61tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_61to62to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_61to63to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_61to64to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_61to65to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_61to66to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_67to68to70:
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, tgc_protocol_0>
   )
   ]
  --[ TgCellNeq( tgc_protocol_0, 'Just_Works' ) ]->
   [ StF( ~pid, 'tgk70', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_67to69to71:
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]
  -->
   [ StF( ~pid, 'tgk71', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_manyto70to72:
   [ StF( ~pid, 'tgk70', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  --[ User_Confirmation_40( tgc_process_id_0 ) ]->
   [ StF( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_manyto71to72:
   [ StF( ~pid, 'tgk71', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  -->
   [ StF( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_manyto72tomany:
   [ StF( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  -->
   [ StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_72to73to74:
   [ StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  --[ Careful_Implementation_42( tgc_process_id_0 ) ]->
   [ StF( ~pid, 'tgk74', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_72to75to76:
   [ StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  --[ Careless_Implementation_43( tgc_process_id_0 ) ]->
   [ StF( ~pid, 'tgk76', <tgc_irk_a_rsp_0, tgc_process_id_0> ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_manyto74:
   [ StF( ~pid, 'tgk74', <'True', 'True', tgc_process_id_0> ) ]
  --[ Distribute_IdKey_41( tgc_process_id_0 ) ]->
   [ ]

  /* has exactly the trivial AC variant */

rule (modulo E) NoInputNoOutput_NoMitm_NoIrk_67_manyto76:
   [ StF( ~pid, 'tgk76', <'True', tgc_process_id_0> ) ]
  --[ Distribute_IdKey_41( tgc_process_id_0 ) ]->
   [ ]

  /* has exactly the trivial AC variant */

/* All well-formedness checks were successful. */

end

==============================================================================
summary of summaries:

analyzed: ./tmp/tmp_smp.tg.spthy

  IRKTheftProofCareless (all-traces): falsified - found trace (5 steps)
  IRKTheftProofCareful (all-traces): verified (20 steps)

==============================================================================
maude tool: 'maude'
 checking version: 2.7.1. OK.
 checking installation: OK.

theory tmp_smp begin

// Function signature and definition of the equational theory E

functions: fst/1, pair/2, snd/1
equations: fst(<x.1, x.2>) = x.1, snd(<x.1, x.2>) = x.2



restriction tg_cell_neq_restriction:
  "¬(∃ x_69 #i_68. TgCellNeq( x_69, x_69 ) @ #i_68)"
  // safety formula

lemma IRKTheftProofCareless:
  all-traces
  "∀ pid #i_50 #k_51.
    ((Distribute_IdKey_41( pid ) @ #i_50) ∧
     (Careless_Implementation_43( pid ) @ #k_51)) ⇒
    (∃ #j_52. (User_Confirmation_40( pid ) @ #j_52) ∧ (#j_52 < #i_50))"
/*
guarded formula characterizing all counter-examples:
"∃ pid #i_50 #k_51.
  (Distribute_IdKey_41( pid ) @ #i_50) ∧
  (Careless_Implementation_43( pid ) @ #k_51)
 ∧
  ∀ #j_52. (User_Confirmation_40( pid ) @ #j_52) ⇒ ¬(#j_52 < #i_50)"
*/
simplify
solve( StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, pid.1>
       ) ▶₀ #k_51 )
  case KeyboardDisplay_NoMitm_NoIrk_67_manyto72tomany_case_5
  solve( Distribute_IdKey_41( ~id_66 ) @ #i_50 )
    case KeyboardDisplay_NoMitm_NoIrk_67_manyto76
    solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_50 )
      case KeyboardDisplay_NoMitm_NoIrk_67_72to75to76
      SOLVED // trace found
    qed
  qed
qed

lemma IRKTheftProofCareful:
  all-traces
  "∀ pid #i_55 #k_56.
    ((Distribute_IdKey_41( pid ) @ #i_55) ∧
     (Careful_Implementation_42( pid ) @ #k_56)) ⇒
    (∃ #j_57. (User_Confirmation_40( pid ) @ #j_57) ∧ (#j_57 < #i_55))"
/*
guarded formula characterizing all counter-examples:
"∃ pid #i_55 #k_56.
  (Distribute_IdKey_41( pid ) @ #i_55) ∧
  (Careful_Implementation_42( pid ) @ #k_56)
 ∧
  ∀ #j_57. (User_Confirmation_40( pid ) @ #j_57) ⇒ ¬(#j_57 < #i_55)"
*/
simplify
solve( StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, pid.1>
       ) ▶₀ #k_56 )
  case KeyboardDisplay_NoMitm_NoIrk_67_manyto72tomany_case_1
  solve( (#vr.1 = #i_55)  ∥ (#i_55 < #vr.1) )
    case case_1
    by solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
  next
    case case_2
    solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
      case KeyboardDisplay_NoMitm_NoIrk_67_manyto74
      by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
    next
      case KeyboardDisplay_NoMitm_NoIrk_67_manyto76
      by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
    qed
  qed
next
  case KeyboardDisplay_NoMitm_NoIrk_67_manyto72tomany_case_2
  solve( (#vr.1 = #i_55)  ∥ (#i_55 < #vr.1) )
    case case_1
    by solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
  next
    case case_2
    solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
      case KeyboardDisplay_NoMitm_NoIrk_67_manyto74
      by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
    next
      case KeyboardDisplay_NoMitm_NoIrk_67_manyto76
      by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
    qed
  qed
next
  case KeyboardDisplay_NoMitm_NoIrk_67_manyto72tomany_case_3
  solve( (#vr.1 = #i_55)  ∥ (#i_55 < #vr.1) )
    case case_1
    by solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
  next
    case case_2
    solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
      case KeyboardDisplay_NoMitm_NoIrk_67_manyto74
      by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
    next
      case KeyboardDisplay_NoMitm_NoIrk_67_manyto76
      by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
    qed
  qed
next
  case KeyboardDisplay_NoMitm_NoIrk_67_manyto72tomany_case_4
  solve( (#vr.1 = #i_55)  ∥ (#i_55 < #vr.1) )
    case case_1
    by solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
  next
    case case_2
    solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
      case KeyboardDisplay_NoMitm_NoIrk_67_manyto74
      by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
    next
      case KeyboardDisplay_NoMitm_NoIrk_67_manyto76
      by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
    qed
  qed
next
  case KeyboardDisplay_NoMitm_NoIrk_67_manyto72tomany_case_5
  solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
    case KeyboardDisplay_NoMitm_NoIrk_67_manyto74
    by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
  next
    case KeyboardDisplay_NoMitm_NoIrk_67_manyto76
    by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
  qed
next
  case KeyboardDisplay_NoMitm_NoIrk_67_manyto72tomany_case_6
  solve( Distribute_IdKey_41( ~id_66 ) @ #i_55 )
    case KeyboardDisplay_NoMitm_NoIrk_67_manyto74
    by solve( StF( ~pid, 'tgk74', <'True', 'True', ~id_66> ) ▶₀ #i_55 )
  next
    case KeyboardDisplay_NoMitm_NoIrk_67_manyto76
    by solve( StF( ~pid, 'tgk76', <'True', ~id_66> ) ▶₀ #i_55 )
  qed
qed

restriction either_careless_or_careful:
  "(∀ pid #i_60.
     (Careful_Implementation_42( pid ) @ #i_60) ⇒
     (¬(∃ #j_61. Careless_Implementation_43( pid ) @ #j_61))) ∧
   (∀ pid #i_63.
     (Careless_Implementation_43( pid ) @ #i_63) ⇒
     (¬(∃ #j_64. Careful_Implementation_42( pid ) @ #j_64)))"
  // safety formula

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_0to1:
   [ Fr( ~pid ) ] --> [ StF( ~pid, 'tgk1', 'empty_tuple' ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_manyto1to2:
   [ StF( ~pid, 'tgk1', 'empty_tuple' ), Fr( ~id_66 ) ]
  -->
   [ StF( ~pid, 'tgk2', <'False', 'KeyboardDisplay', 'False', ~id_66> ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_manyto2to3:
   [
   StF( ~pid, 'tgk2',
        <tgc_idkey_0, tgc_iocap_0, tgc_mitm_0, tgc_process_id_0>
   )
   ]
  -->
   [
   StF( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_mitm_0, tgc_process_id_0>
   ),
   Out( <'Pairing_Request', tgc_idkey_0, tgc_mitm_0, tgc_iocap_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_manyto3tomany:
   [
   StF( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_mitm_0, tgc_process_id_0>
   ),
   In( <'Pairing_Response', idkey_47, mitm_45, iocap_46> )
   ]
  -->
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, iocap_46, idkey_47, tgc_mitm_0, mitm_45, 
         tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_3to4to67:
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 'False', 
         'False', tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_3to5tomany:
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 'True', 
         tgc_mitm_b_0, tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_5to6tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_6to7to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_6to8to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_6to9to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_6to10to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_6to11to67:
   [
   StB( ~pid, 'tgk6',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_5to12tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayYesNo', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_12to13to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_12to14to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_12to15to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_12to16to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_12to17to67:
   [
   StB( ~pid, 'tgk12',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_5to18tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_18to19to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_18to20to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_18to21to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_18to22to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_18to23to67:
   [
   StB( ~pid, 'tgk18',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_5to24tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_24to25to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_24to26to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_24to27to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_24to28to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_24to29to67:
   [
   StB( ~pid, 'tgk24',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_5to30tomany:
   [
   StB( ~pid, 'tgk5',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_30to31to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_30to32to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_30to33to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_30to34to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_30to35to67:
   [
   StB( ~pid, 'tgk30',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_3to36tomany:
   [
   StB( ~pid, 'tgk3',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, tgc_mitm_0, 
         'True', tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, tgc_iocap_b_0, tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_36to37tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_37to38to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_37to39to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_37to40to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_37to41to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_37to42to67:
   [
   StB( ~pid, 'tgk37',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_36to43tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'DisplayYesNo', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_43to44to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_43to45to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_43to46to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_43to47to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_43to48to67:
   [
   StB( ~pid, 'tgk43',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_36to49tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardOnly', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_49to50to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_49to51to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_49to52to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_49to53to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_49to54to67:
   [
   StB( ~pid, 'tgk49',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_36to55tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_55to56to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_55to57to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_55to58to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_55to59to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_55to60to67:
   [
   StB( ~pid, 'tgk55',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_36to61tomany:
   [
   StB( ~pid, 'tgk36',
        <tgc_idkey_0, tgc_iocap_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, 
         tgc_process_id_0>
   )
   ]
  -->
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, tgc_iocap_0, tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_61to62to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'DisplayOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_ADBI'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_61to63to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'DisplayYesNo', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_61to64to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'KeyboardOnly', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Passkey_Entry_AIBD'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_61to65to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'NoInputNoOutput', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_61to66to67:
   [
   StB( ~pid, 'tgk61',
        <tgc_idkey_0, 'KeyboardDisplay', tgc_irk_a_rsp_0, tgc_process_id_0>
   )
   ]
  -->
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Numeric_Comparison'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_67to68to70:
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, tgc_protocol_0>
   )
   ]
  --[ TgCellNeq( tgc_protocol_0, 'Just_Works' ) ]->
   [ StF( ~pid, 'tgk70', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_67to69to71:
   [
   St( ~pid, 'tgk67',
       <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0, 'Just_Works'>
   )
   ]
  -->
   [ StF( ~pid, 'tgk71', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_manyto70to72:
   [ StF( ~pid, 'tgk70', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  --[ User_Confirmation_40( tgc_process_id_0 ) ]->
   [ StF( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_manyto71to72:
   [ StF( ~pid, 'tgk71', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  -->
   [ StF( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_manyto72tomany:
   [ StF( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  -->
   [ StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_72to73to74:
   [ StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  --[ Careful_Implementation_42( tgc_process_id_0 ) ]->
   [ StF( ~pid, 'tgk74', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_72to75to76:
   [ StB( ~pid, 'tgk72', <tgc_idkey_0, tgc_irk_a_rsp_0, tgc_process_id_0> )
   ]
  --[ Careless_Implementation_43( tgc_process_id_0 ) ]->
   [ StF( ~pid, 'tgk76', <tgc_irk_a_rsp_0, tgc_process_id_0> ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_manyto74:
   [ StF( ~pid, 'tgk74', <'True', 'True', tgc_process_id_0> ) ]
  --[ Distribute_IdKey_41( tgc_process_id_0 ) ]->
   [ ]

  /* has exactly the trivial AC variant */

rule (modulo E) KeyboardDisplay_NoMitm_NoIrk_67_manyto76:
   [ StF( ~pid, 'tgk76', <'True', tgc_process_id_0> ) ]
  --[ Distribute_IdKey_41( tgc_process_id_0 ) ]->
   [ ]

  /* has exactly the trivial AC variant */

/* All well-formedness checks were successful. */

end

==============================================================================
summary of summaries:

analyzed: ./tmp/tmp_smp.tg.spthy

  IRKTheftProofCareless (all-traces): falsified - found trace (5 steps)
  IRKTheftProofCareful (all-traces): verified (28 steps)

==============================================================================
