# credential.py
## PS Signature Scheme
To generate a key pair for a message vector of length L
```
attributes: List of size L:
sk, pk = generate_key(attributes)
```

To sign a message vector of size L (This method is never used in the implementation of ABC):
```
attributes: List[bytes] of size L
sk: SecretKey
sig = sign(sk, attributes)
```

To verify a signature against a message vector (This method is never used in the implementation of ABC):
```
pk: PublicKey
sig: Signature,
attributes: List[bytes] of size L
assert verify(pk, sig, attributes)
```

## Attribute-Based Credentials
Instead of the original template, this part is re-organized in a more object-oriented fashion. 
More specifically, the operations are grouped by the role by which they are invoked, i.e. Issuer, 
User and Verifier.

### Issuer
The issuer controls the secret key, and is responsible for verifying the validity of credential 
issuance requests generated by User and generate the signature used to for creating credentials. 
```
sk: SecretKey
pk: PublicKey
Issuer(sk, pk)
```

### User
The user is responsible for initializing the issuance process by sending the issuance request to
the issuer, and compute the final credential upon receipt of the issuer's response. The user is 
also creates disclosure proofs to show possession of the credentials.
```
pk: PublicKey
User(pk)
```

### Verifier (No Corresponding Class)
The verifier is not made into a class, as this role is in general more volatile than the other 2, 
as everyone in possession of the public key can verify the validity of the signature.

### Simple Example
```
user = User(pk)
user_attributes: Dict[int, bytes] mapping from each user attribute index to the attribute value

issuer = Issuer(sk, pk)
issuer_attributes: Dict[int, bytes] mapping from each issuer attribute index to the attribute value

request = user.create_issue_request(user_attributes)
response = issuer.sign_issue_request(request, issuer_attributes)
credential = user.obtain_credential(response) 

<!-- Here completes the credential issuance phase -->

# credential is automatically loaded in obtain_credential()
# However for newly instantiated User, credential can be loaded manually
user.load_credential(credential)

disclosed_attributes: List[bytes] list of names of attributes
signature = user.create_disclosure_proof(disclosed_attributes, message)
assert verify_disclosure_proof(pk, signature, message)
```

# stroll.py
## Credential Issuance
```
server = Server()
client = Client()

sk, pk = Server.generate_ca(all_subscriptions)
request, state = client.prepare_registration(pk, username, user_subscriptions)
response = server.process_registration(sk, pk, request, username, user_subscriptions)
credentials = client.process_registration_response(pk, response, state)
```

## POI Request
```
signature = client.sign_request(pk, credentials, message, disclosed_subscriptions)
assert server.check_request_signature(pk, message, disclosed_subscriptions, signature)
```